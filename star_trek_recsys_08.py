# -*- coding: utf-8 -*-
# for python 3
import math
from scipy.stats import pearsonr
import random
import pickle


MyMediaLite_path="mymedialite/"

# episode_id:((central_themes),(peripheral_themes)),
EPISODE_THEMES={
"tas1x01":((179,358,455,697,705,814,),(443,632,645,694,)),
"tas1x02":((185,673,1052,1356,1357,1393,1459,),(126,298,479,739,742,754,891,947,1354,)),
"tas1x03":((28,66,121,1037,1170,1214,1235,1514,),(603,1047,1360,1398,)),
"tas1x04":((680,691,724,745,758,1237,1504,1687,),(692,1187,)),
"tas1x05":((369,548,658,739,782,1381,),(399,405,)),
"tas1x06":((425,500,710,838,1072,1403,),(283,455,1325,)),
"tas1x07":((428,605,755,832,833,919,),(58,1261,1520,)),
"tas1x08":((15,136,179,210,850,1222,1227,1228,1287,1305,1449,1458,1489,),(14,75,887,1332,)),
"tas1x09":((588,728,729,741,814,1010,1061,1484,1832,),()),
"tas1x10":((125,967,997,1256,1403,1448,),(233,356,581,739,)),
"tas1x11":((24,358,464,1170,1461,),(1163,1337,1425,)),
"tas1x12":((12,213,231,676,743,1440,1605,),()),
"tas1x13":((507,835,1082,1442,),(11,66,224,548,694,1520,)),
"tas1x14":((455,537,584,814,1145,1430,),(490,626,694,951,1047,1067,1231,1411,)),
"tas1x15":((69,463,631,740,1092,1370,1372,1472,1527,),(1011,1188,1192,1193,1516,)),
"tas1x16":((538,742,1217,),(197,308,511,680,1403,)),
"tas2x01":((718,1125,1386,),(107,369,)),
"tas2x02":((59,61,63,65,66,69,249,325,),(1071,)),
"tas2x03":((412,464,741,),(555,742,1418,)),
"tas2x04":((456,467,551,577,873,1465,),(684,766,1118,1500,)),
"tas2x05":((14,65,69,455,740,792,942,1201,1202,1290,1295,1319,),(1079,)),
"tas2x06":((89,246,749,1004,1006,1321,1435,1446,),(840,841,)),
"tng1x01":((69,195,438,617,654,1122,1370,1372,),(7,83,125,210,246,321,340,358,391,413,527,600,630,664,700,804,947,951,1022,1034,1234,1290,1295,1418,1420,1687,2062,)),
"tng1x03":((49,434,656,997,1091,1477,2128,),(83,234,457,499,511,583,666,724,757,804,1066,1081,1163,1366,1511,)),
"tng1x04":((27,63,125,195,325,369,453,455,597,618,664,713,758,759,894,951,1220,1253,1257,1403,1451,),(41,48,84,97,308,394,495,600,686,720,724,818,819,953,1067,1104,1273,1410,1416,1418,1518,)),
"tng1x05":((66,69,82,195,231,325,443,455,773,893,1131,1386,),(97,125,201,464,675,730,814,951,1067,1159,1163,1256,)),
"tng1x06":((179,408,601,686,772,951,1305,1449,),(48,49,78,97,297,379,482,503,547,617,674,757,804,902,913,1050,1065,1194,1283,1416,1484,)),
"tng1x07":((84,325,399,427,457,464,632,633,720,),(60,63,167,219,343,363,376,487,511,564,764,804,887,909,934,994,1138,1231,1518,)),
"tng1x08":((35,49,63,65,66,168,219,221,325,394,526,590,1252,1363,1492,2036,),(27,60,180,195,240,407,460,511,525,547,600,724,757,773,804,848,951,)),
"tng1x09":((84,455,479,700,832,833,891,1222,1412,1518,),(83,125,267,290,362,380,535,783,828,970,991,1047,1067,1131,1366,1416,)),
"tng1x10":((42,547,566,601,686,720,772,944,951,1191,1370,1372,1449,),(83,195,257,453,724,899,1038,1050,1300,1384,1451,)),
"tng1x11":((102,325,359,500,760,803,1123,1188,1226,1235,1241,),(86,93,144,197,214,220,456,482,564,664,687,920,951,1167,1410,1416,1516,)),
"tng1x12":((7,66,325,535,741,890,1279,1418,),(9,87,125,312,321,367,511,645,738,950,951,1012,1022,1034,1167,1256,1518,)),
"tng1x13":((7,83,150,161,207,664,722,728,1075,1271,),(43,48,93,136,137,321,324,738,951,1022,1034,1127,1167,1280,1288,1386,1416,1518,)),
"tng1x14":((66,114,195,210,219,325,366,745,758,764,790,850,893,981,996,1067,1241,1494,),(27,60,87,137,168,341,378,380,407,535,600,617,618,639,664,674,724,750,773,853,1135,1153,1195,1196,1386,1504,)),
"tng1x15":((7,141,358,570,728,741,984,1078,1189,1279,),(95,317,325,380,457,487,639,773,872,893,1066,1170,1418,)),
"tng1x16":((89,246,307,341,454,455,991,1195,1221,1222,),(197,223,234,358,363,417,618,779,840,841,896,1021,1022,1191,1196,1311,1494,1518,)),
"tng1x17":((113,184,189,260,358,361,463,571,648,740,757,807,891,976,1086,1169,1293,),(97,128,155,172,182,340,363,478,479,521,680,695,803,804,864,918,951,984,1035,1043,1309,1348,)),
"tng1x18":((27,66,324,777,832,833,1063,1192,1193,1260,1279,1493,),(84,87,816,1047,1119,1325,1398,1491,)),
"tng1x19":((49,192,280,289,466,547,577,680,699,720,1013,1095,1194,1399,),(180,225,253,357,521,591,594,617,640,730,1011,1059,1139,1223,1385,)),
"tng1x20":((84,136,363,396,397,521,597,719,895,906,987,1052,1288,1528,),(60,123,292,951,1282,1420,)),
"tng1x21":((100,101,125,680,728,741,814,1010,1150,1309,1402,2045,2046,),(93,192,197,305,482,521,720,885,896,990,1061,1223,1511,)),
"tng1x22":((27,125,198,329,358,391,392,394,438,764,802,850,976,1098,1256,1365,1407,),(113,195,210,213,376,547,564,1065,1194,)),
"tng1x23":((294,321,454,455,460,572,700,738,913,962,973,1022,1034,1090,1214,1235,1237,1258,1269,1518,),(210,339,420,664,674,705,814,818,943,1024,1139,1194,1418,)),
"tng1x24":((276,677,714,741,829,838,991,1047,1152,1216,1262,1353,),(93,618,713,858,893,899,961,982,1165,1272,1356,1418,)),
"tng1x25":((122,225,425,451,645,738,),(294,321,376,532,564,590,835,951,982,1022,1273,1352,1384,1416,)),
"tng1x26":((44,136,207,275,322,323,325,432,484,890,1311,1476,),(78,87,97,125,231,244,246,304,413,535,547,564,572,590,600,601,617,618,724,761,947,951,1065,1256,1386,1520,)),
"tng2x01":((66,69,183,632,633,644,651,757,804,1332,),(8,39,62,180,197,290,363,436,503,572,664,666,683,805,947,1091,1264,1400,1417,)),
"tng2x02":((63,66,69,358,444,455,651,743,826,1030,1214,1235,1267,1332,1370,),(61,219,311,321,506,534,644,662,733,738,825,887,973,1022,1034,1093,1172,1194,1325,1416,)),
"tng2x03":((7,8,9,343,455,741,947,1078,1279,1290,1418,),(97,129,567,600,651,733,934,1022,1332,)),
"tng2x04":((445,516,661,849,),(27,49,83,87,155,478,479,500,511,535,600,617,647,674,724,860,891,893,1008,1065,1074,1126,1137,1273,1290,1368,1505,)),
"tng2x05":((214,234,302,366,427,764,860,981,1189,),(48,97,208,228,231,363,521,572,639,893,906,951,1011,1053,1245,1383,)),
"tng2x06":((8,9,83,358,787,947,1271,1311,),(131,187,246,283,572,651,664,724,899,951,973,979,1403,1416,1518,1524,)),
"tng2x07":((197,211,363,394,548,601,613,767,885,906,921,1011,1334,),(210,266,442,517,591,617,1047,1059,1153,1171,1190,1237,1311,1325,1416,)),
"tng2x08":((66,136,160,176,275,325,326,396,597,719,893,1154,1528,1923,),(49,60,63,93,249,363,376,455,511,564,600,617,651,680,686,724,733,951,973,1013,1050,1167,1309,1416,1518,)),
"tng2x09":((7,8,9,83,197,397,467,728,980,1279,1387,),(75,363,651,684,906,1085,1332,)),
"tng2x10":((49,197,207,254,269,359,398,505,516,639,1072,1184,),(84,180,363,575,651,686,705,739,1013,1191,1352,1416,1418,1518,)),
"tng2x11":((100,432,741,814,1179,),(117,292,358,535,547,651,728,882,912,1011,1059,1339,)),
"tng2x12":((66,69,463,740,1079,1290,1470,),(18,152,155,420,535,547,583,639,724,814,826,934,)),
"tng2x13":((95,418,464,743,1047,1053,1353,1356,1459,),(78,97,927,1059,)),
"tng2x14":((40,192,197,223,479,480,503,733,891,951,980,1013,1223,),(60,84,136,169,210,275,325,379,532,587,674,829,838,871,979,)),
"tng2x15":((7,27,49,210,231,240,260,363,394,532,535,674,680,772,1028,1053,1180,1309,),(87,93,720,769,856,931,1136,)),
"tng2x16":((66,69,179,203,204,332,358,455,460,482,483,601,741,1011,1332,1370,),(9,84,95,119,130,301,312,376,572,651,686,887,951,983,1172,1223,1518,)),
"tng2x17":((454,547,617,1056,1131,),(197,625,674,733,740,893,961,1091,1301,)),
"tng2x18":((39,200,231,358,386,549,605,764,820,917,1111,1170,1261,1346,),(87,180,308,325,407,478,546,564,600,639,724,893,951,1071,1091,1119,1167,1310,)),
"tng2x19":((277,535,592,724,803,832,834,1188,1287,1403,),(87,155,308,361,411,507,707,709,940,947,1418,1516,)),
"tng2x20":((231,597,778,810,829,838,966,980,1157,1344,1528,),(153,180,363,380,715,724,906,973,1088,1089,1091,1167,1171,1183,1418,1518,)),
"tng2x21":((460,680,686,782,951,1013,1053,1309,),(8,83,125,155,228,253,280,363,534,641,720,902,1052,1131,1214,1235,1256,1312,)),
"tng2x22":((240,241,244,311,532,572,1194,1283,),(724,920,1376,)),
"tng3x01":((7,9,66,325,412,686,741,815,832,833,1057,1062,1331,1832,),(48,49,180,352,363,588,631,724,772,804,823,951,982,991,1011,1056,1091,1163,1183,1217,1398,1518,1972,)),
"tng3x02":((7,8,63,66,69,83,114,117,219,250,366,369,568,631,680,860,947,996,1052,1150,1252,1309,1520,),(48,351,363,368,376,521,592,596,720,893,951,1003,1007,1255,1403,1416,)),
"tng3x03":((69,572,634,865,945,991,1047,1071,1222,1234,1315,1370,1372,1389,1518,1687,),(22,68,97,114,119,197,210,213,267,300,358,379,455,459,600,617,618,647,674,700,705,840,841,906,973,979,1022,1065,1191,1492,)),
"tng3x04":((27,239,394,470,588,942,953,1039,),(14,78,127,413,478,482,617,891,1022,1076,1332,2031,)),
"tng3x05":((50,66,69,183,268,281,297,325,572,575,757,804,856,857,991,1180,1360,),(84,210,347,363,503,556,600,666,674,906,1240,1270,1430,)),
"tng3x06":((639,704,1078,1391,1418,),(43,48,154,217,283,363,407,521,724,882,922,1156,1304,1403,1498,1511,)),
"tng3x07":((231,234,325,432,588,641,733,742,947,966,971,980,995,1026,1383,1386,),(43,84,311,417,532,674,723,730,773,893,895,1420,1518,)),
"tng3x08":((125,468,639,818,923,1011,1013,1053,1188,1223,1256,1277,1517,),(48,153,368,376,398,532,564,590,655,686,709,713,724,728,951,1022,1065,1131,1386,)),
"tng3x09":((195,427,639,940,980,981,1222,1295,1412,),(66,75,80,84,87,125,137,325,376,398,511,724,764,790,818,832,833,1091,1290,)),
"tng3x10":((137,358,363,425,427,432,723,895,906,941,946,1152,1378,1386,),(45,84,87,136,226,275,376,521,587,704,951,1028,1035,1047,1167,1197,1265,)),
"tng3x11":((194,281,358,550,783,850,955,1235,1241,1290,1322,1379,),(97,195,420,487,617,740,899,954,973,1065,)),
"tng3x12":((31,193,210,341,365,417,427,454,740,804,850,976,1069,1195,1196,1319,2062,),(84,240,321,394,482,483,639,674,885,1022,1049,1157,1518,)),
"tng3x13":((136,210,278,601,617,674,686,773,893,913,951,1071,1180,1271,1370,2082,),(87,97,132,380,407,542,600,647,801,1026,1091,1170,1194,1222,1281,1282,1372,1416,)),
"tng3x14":((41,75,219,221,397,445,467,468,577,684,724,1306,1403,1418,1465,),(84,87,101,104,125,180,366,572,600,618,641,664,700,872,905,973,1051,1167,1222,1256,1383,1384,1518,)),
"tng3x15":((28,291,294,311,363,469,521,639,906,1059,1214,1235,1304,1356,1357,),(97,231,275,455,572,597,600,674,720,837,1022,1152,1167,1213,1528,)),
"tng3x16":((7,8,9,49,83,136,183,197,290,331,394,478,651,728,947,1052,1264,1271,1279,1285,),(48,97,340,486,503,511,572,594,666,745,891,893,1017,1282,1293,1332,)),
"tng3x17":((136,161,467,479,597,653,895,1024,1298,1378,1528,),(84,232,325,363,521,577,684,700,722,853,893,906,951,973,1139,1222,1257,1288,1518,)),
"tng3x18":((66,69,219,231,325,630,651,680,720,813,966,1290,1332,1385,1386,),(57,61,80,81,87,232,321,376,463,482,555,641,740,865,899,920,951,952,961,1309,1510,1518,)),
"tng3x19":((308,639,1294,),(87,125,137,155,180,236,360,379,380,534,590,600,651,713,724,1065,1131,1256,1257,1332,1356,1386,1403,)),
"tng3x20":((136,357,358,697,705,1188,1287,1292,1437,1503,1516,),(7,83,93,100,132,223,280,325,354,379,455,617,733,770,814,915,979,991,1163,1174,1373,1387,)),
"tng3x21":((136,231,287,317,372,424,532,733,861,893,966,1053,1091,1414,1418,1512,),(43,87,97,163,210,249,308,363,379,380,464,521,590,641,674,724,862,899,979,1095,1183,1298,1317,1403,)),
"tng3x22":((7,9,83,125,291,294,362,463,686,740,865,888,1234,1256,1269,1290,1687,),(87,137,210,229,321,346,455,482,572,590,617,666,674,700,720,738,773,893,951,1022,1034,1052,1220,)),
"tng3x23":((84,207,246,284,352,413,653,976,1054,1299,1393,1516,1568,2129,),(29,60,87,181,210,325,354,379,380,600,617,618,674,757,795,800,804,840,841,847,886,933,973,979,1017,1035,1059,1065,1191,1518,)),
"tng3x24":((125,432,724,757,803,832,834,965,1024,1152,1188,1403,),(66,87,97,321,368,376,407,590,683,709,740,763,804,1022,1067,1148,)),
"tng3x25":((383,639,674,790,850,885,1053,1214,1235,1370,1392,1464,),(66,97,142,210,219,230,247,308,386,455,460,547,600,617,679,724,999,1065,1403,1449,)),
"tng3x26":((69,119,192,197,203,204,332,358,455,459,460,741,966,983,1011,1013,1170,1223,1510,),(87,97,213,266,291,294,572,617,680,720,817,836,943,1047,1309,1416,)),
"tng4x01":((69,119,203,207,332,381,455,459,460,572,598,680,983,1150,1170,1349,1511,),(197,305,482,641,730,853,1416,)),
"tng4x02":((161,192,197,224,230,281,476,479,503,664,733,757,804,891,980,989,1013,1052,1075,1152,),(48,84,87,90,173,183,185,210,297,300,411,522,552,553,564,572,597,600,618,651,674,680,763,819,951,1017,1035,1056,1139,1191,1394,1418,)),
"tng4x03":((83,161,297,479,664,732,891,980,991,1075,1279,),(78,84,210,321,340,380,457,503,517,572,587,733,738,741,1022,1034,1167,1293,1423,1518,)),
"tng4x04":((31,49,51,63,66,136,183,189,191,197,219,260,275,325,331,369,396,479,575,722,891,1017,1152,1185,),(48,60,84,87,181,363,503,521,572,587,674,733,893,894,1091,1518,)),
"tng4x05":((202,355,464,743,970,1047,1305,1480,),(48,87,97,235,240,268,300,343,547,572,666,757,772,804,1065,1416,)),
"tng4x06":((136,137,291,294,532,1054,1383,1384,),(80,194,301,321,397,454,572,647,818,989,1022,1084,1268,1416,)),
"tng4x07":((300,397,572,597,618,764,1222,1257,1369,1412,1528,),(183,297,453,479,647,700,715,757,804,891,940,973,1080,1167,1288,1400,1416,1451,1518,)),
"tng4x08":((207,247,261,560,705,856,970,1386,1418,1476,1480,),(78,84,97,210,300,420,618,645,674,857,1416,)),
"tng4x09":((680,720,733,742,1011,1017,1150,1309,1474,),(48,49,56,97,158,169,197,238,240,249,564,580,617,757,804,814,893,951,972,1091,1153,1183,1298,)),
"tng4x10":((5,6,234,743,1052,1053,1188,2082,),(87,97,148,210,300,352,380,534,572,674,899,1304,)),
"tng4x11":((7,83,263,425,515,532,618,653,715,760,1152,1271,),(87,343,666,712,754,899,928,1182,1207,)),
"tng4x12":((41,313,325,369,397,417,427,433,577,700,718,832,947,966,971,973,980,995,1022,1050,1069,1222,1518,),(376,532,600,674,1048,1359,1416,)),
"tng4x13":((125,338,438,470,523,819,820,986,1039,1227,1233,1239,1256,),(45,78,83,93,180,229,376,404,468,482,561,625,684,724,951,1076,1194,1265,1403,)),
"tng4x14":((66,69,83,358,396,399,651,663,1332,1370,1383,1520,1521,),(7,87,363,644,773,804,817,893,1192,1193,1194,1418,1517,)),
"tng4x15":((27,68,224,325,327,377,663,),(33,78,175,487,511,513,561,617,647,724,885,1416,2031,)),
"tng4x16":((283,724,966,980,991,1129,1180,1234,1317,1403,1687,),(43,84,87,197,376,587,588,596,641,1035,1167,1418,)),
"tng4x17":((47,72,231,273,358,482,483,486,743,970,1087,1194,1426,1480,1568,),(13,84,87,281,355,664,715,2129,)),
"tng4x18":((95,178,482,1073,1464,),(236,532,638,1046,1383,1384,1418,)),
"tng4x19":((69,457,601,686,788,860,1053,1370,1450,1464,),(45,66,87,308,344,372,379,482,651,674,951,979,1183,1214,1219,1235,1329,1330,1403,1418,)),
"tng4x20":((559,639,951,1056,1370,),(99,180,308,311,358,411,420,647,664,713,715,724,740,882,973,1518,)),
"tng4x21":((41,225,361,577,832,850,947,971,1022,1232,1314,1465,),(48,84,97,142,363,376,467,684,704,951,1416,)),
"tng4x22":((60,63,69,159,219,224,226,246,280,318,325,400,429,588,639,1149,1152,1170,1188,1289,),(66,84,363,379,407,572,617,663,705,803,893,895,906,941,2062,)),
"tng4x23":((383,639,711,764,909,980,981,1011,1028,1174,),(180,491,547,562,580,666,685,724,885,1035,1167,1374,)),
"tng4x24":((368,432,783,940,1528,),(262,281,564,577,941,1022,1319,1418,)),
"tng4x25":((7,83,639,837,1275,),(29,43,283,335,516,591,666,712,743,754,893,1035,1053,1066,1416,)),
"tng4x26":((136,161,194,597,647,680,720,764,1221,1235,1241,1431,1528,),(29,376,600,721,973,1167,1518,)),
"tng5x01":((8,161,194,231,597,764,947,1150,1221,1431,1528,),(29,87,136,197,564,641,680,720,730,773,779,922,973,1011,1223,1257,1518,1884,)),
"tng5x02":((34,66,69,325,452,631,733,739,775,1386,),(97,294,409,455,547,572,651,893,1011,1059,1248,1398,1416,)),
"tng5x03":((136,193,341,358,448,449,451,719,895,1069,1195,1196,1386,1510,),(87,155,197,256,266,325,379,491,580,629,647,779,899,948,2062,)),
"tng5x04":((324,691,700,832,833,995,1127,1222,1234,1315,1687,),(8,83,84,231,290,417,482,572,703,724,757,804,906,947,991,1022,1423,1518,)),
"tng5x05":((231,340,342,591,680,1059,1150,1214,1235,1309,1511,),(87,155,232,240,305,482,521,743,1997,)),
"tng5x06":((49,464,590,639,746,783,901,1091,1184,1414,1478,),(231,407,455,564,666,724,804,1002,1065,1167,1257,1416,)),
"tng5x07":((425,432,479,719,980,981,991,1384,1392,1393,),(29,48,244,294,345,572,891,951,1065,1298,1339,2049,)),
"tng5x08":((197,425,432,479,891,980,981,1094,1386,1393,1395,2049,),(224,294,297,363,459,521,564,724,906,1011,1017,1065,2031,)),
"tng5x09":((125,252,509,1214,1235,1256,1356,1357,2019,),(84,87,110,380,552,553,600,641,686,933,1059,1206,1243,1332,1403,)),
"tng5x10":((183,479,572,597,858,891,1216,),(87,184,297,363,371,380,407,416,481,816,893,990,995,1080,1102,1134,1183,1264,1288,1365,1509,)),
"tng5x11":((7,83,136,183,268,281,297,424,733,856,991,1017,),(48,210,348,350,572,674,872,1065,1165,1264,)),
"tng5x12":((281,479,744,959,960,1188,1318,1516,),(165,321,577,600,617,724,738,906,1022,1034,1194,1276,1416,1518,)),
"tng5x13":((27,37,224,394,428,516,548,549,663,714,853,1151,1170,1241,1290,1334,1348,1367,),(48,75,172,234,359,376,387,529,600,601,641,651,686,724,823,906,933,951,1065,1119,1167,)),
"tng5x14":((395,473,639,769,1388,1490,),(87,97,266,427,617,686,713,724,730,951,1167,1304,1416,)),
"tng5x15":((341,358,454,455,483,632,818,954,1379,),(240,320,321,618,738,760,973,1022,1034,1059,1194,1483,1518,)),
"tng5x16":((33,66,226,234,325,358,384,429,437,479,532,597,689,891,951,1011,1052,1152,1299,),(43,197,210,297,354,376,503,616,674,885,1071,1348,)),
"tng5x17":((63,66,195,206,219,325,398,516,544,734,850,1068,2062,),(532,651,724,745,853,941,1404,)),
"tng5x18":((95,343,401,464,704,743,1353,1356,1515,),(97,179,974,1047,1416,)),
"tng5x19":((49,137,268,294,397,577,596,601,647,719,720,898,951,991,1050,1180,1383,1384,1526,),(97,572,680,757,804,806,904,990,1056,1302,1309,)),
"tng5x20":((183,184,197,214,246,371,479,481,590,595,891,1264,1291,),(48,60,87,110,155,180,308,325,376,500,715,803,846,893,958,966,1080,1183,1188,1418,)),
"tng5x21":((66,102,269,356,398,434,516,639,647,653,724,997,1085,1290,1460,1507,2062,),(125,143,180,380,420,600,664,687,802,980,981,1035,1065,1256,1274,2129,)),
"tng5x22":((69,136,184,464,556,624,633,744,757,891,1240,),(43,87,97,397,478,632,651,664,705,817,843,973,1035,1194,1509,1518,)),
"tng5x23":((66,86,144,203,204,210,211,332,381,588,674,733,741,773,893,1069,1214,1235,1274,1287,1315,),(281,532,651,700,705,1383,1384,1404,)),
"tng5x24":((136,291,294,301,343,470,532,556,572,1205,1471,),(207,547,1065,1141,1167,1190,1416,)),
"tng5x25":((170,237,400,618,760,1170,1278,1297,1456,),(43,49,78,127,246,275,294,300,358,363,413,478,479,503,521,532,565,572,666,680,832,833,886,891,)),
"tng5x26":((7,83,359,844,1356,),(32,78,175,278,397,535,572,691,890,1289,1458,)),
"tng6x01":((7,83,359,691,844,1356,),(45,87,535,588,651,890,1167,1458,)),
"tng6x02":((47,310,466,620,1194,1376,),(95,98,532,591,893,970,1052,1053,1190,1416,)),
"tng6x03":((355,664,764,834,976,1214,1235,1516,),(235,246,321,376,385,434,511,577,724,738,893,951,973,980,981,1022,1065,1188,1241,1410,1518,1568,2129,)),
"tng6x04":((17,136,246,307,330,733,890,1053,1299,1476,),(48,87,169,210,233,249,420,534,564,600,651,674,828,893,990,1017,1190,1294,1321,1418,1458,)),
"tng6x05":((57,61,273,444,464,591,1011,1194,1332,),(69,231,380,441,563,651,712,754,939,1166,1167,1183,1416,1418,1422,)),
"tng6x06":((49,136,186,566,601,997,1300,1360,1370,1403,1449,),(42,84,87,93,97,180,197,210,297,404,421,503,572,617,664,674,686,724,757,772,891,944,951,1017,1091,1191,1372,1522,)),
"tng6x07":((89,125,182,184,231,237,457,534,909,1256,1445,1447,),(170,321,491,515,617,618,666,680,720,1022,1131,1167,1264,1291,1309,1416,2082,)),
"tng6x08":((455,479,741,891,1418,),(83,131,155,308,380,559,811,1264,1294,1329,1403,1518,)),
"tng6x09":((7,8,9,124,363,395,647,789,802,832,833,906,976,1279,1493,),(83,131,210,591,651,745,750,1023,1832,)),
"tng6x10":((176,197,232,287,433,680,951,966,1309,),(86,87,250,266,369,899,906,)),
"tng6x11":((197,201,262,321,346,425,433,455,598,636,700,738,740,779,956,1022,1034,1308,1392,),(87,160,176,232,267,369,564,906,951,966,1023,1194,1235,)),
"tng6x12":((7,9,422,455,740,741,890,1078,1079,1279,1290,1333,1418,),(137,330,343,358,540,666,1190,1237,1305,1416,)),
"tng6x13":((240,467,577,639,1383,1465,1886,),(87,368,398,420,798,1084,1105,1188,1223,1516,1528,)),
"tng6x14":((197,345,425,432,895,900,991,1028,1053,1150,),(87,97,413,655,951,1022,1392,1518,2031,)),
"tng6x15":((363,991,1011,1052,1152,1213,1219,1356,1446,1523,1526,),(137,170,213,376,472,489,590,601,674,829,838,893,906,951,973,1222,1410,1518,)),
"tng6x16":((83,479,597,732,891,951,1052,1283,1426,),(87,352,925,973,1332,1518,)),
"tng6x17":((210,516,597,623,635,740,947,971,1028,1071,1094,1288,),(48,49,136,340,376,479,651,674,)),
"tng6x18":((125,341,455,457,591,1195,1256,),(87,251,600,651,931,1207,1416,1511,)),
"tng6x19":((138,398,639,837,886,),(43,97,240,380,572,591,666,709,742,1059,)),
"tng6x20":((16,64,231,432,433,614,814,1297,1326,1332,1434,1528,),(48,99,117,294,572,651,666,686,772,882,934,964,966,991,1042,1167,1226,)),
"tng6x21":((47,350,355,462,463,577,740,770,970,1290,1380,1465,1480,),(45,93,173,354,358,973,1047,1167,1194,1283,1518,)),
"tng6x22":((197,361,363,385,521,832,833,906,971,1027,1143,1325,2049,),(48,87,91,231,291,577,600,664,674,1298,1393,1528,)),
"tng6x23":((470,597,605,774,987,988,1052,1261,1285,1458,1528,1958,),(48,78,239,393,407,489,680,720,773,893,899,909,951,1091,1183,1191,1257,1309,1343,1416,1518,)),
"tng6x24":((36,196,197,261,465,664,714,829,909,966,1013,1047,1223,1459,),(78,87,131,136,153,210,266,407,617,674,686,980,1026,1190,)),
"tng6x25":((444,702,743,1011,1439,),(149,255,432,1272,1356,1416,)),
"tng6x26":((83,84,332,700,973,1052,1155,1222,1274,1518,),(7,203,397,532,545,666,738,937,991,1034,1047,1179,1458,)),
"tng7x01":((7,83,84,137,161,203,332,438,455,532,670,700,738,768,1022,1034,1150,1269,1518,),(136,210,321,482,522,616,664,674,866,1235,)),
"tng7x02":((63,66,69,325,326,1271,1332,),(60,84,180,188,253,363,564,590,651,740,893,1139,1403,1518,)),
"tng7x03":((297,352,464,572,598,804,1054,1079,1286,1383,1384,1419,),(83,93,97,210,358,361,380,397,532,541,633,718,991,1167,)),
"tng7x04":((291,294,572,720,850,1218,1286,),(84,99,229,232,321,482,738,870,882,1022,1034,1125,1512,)),
"tng7x05":((197,1257,),(83,84,99,232,321,432,455,482,524,738,870,882,1022,1034,1125,1332,1393,1416,)),
"tng7x06":((7,83,355,464,970,1052,1283,1426,1480,),(20,93,155,390,482,564,651,659,712,754,1418,1458,)),
"tng7x07":((66,132,173,220,290,325,572,631,757,803,991,1188,1516,),(20,87,208,210,240,340,380,478,482,503,651,681,1167,1426,)),
"tng7x08":((195,365,368,427,663,784,905,920,1403,1437,1520,),(87,228,231,425,482,487,561,742,951,1056,1416,)),
"tng7x09":((363,403,421,521,591,906,1028,1241,),(29,48,85,162,197,299,532,572,617,686,712,754,832,833,951,1050,1325,1463,)),
"tng7x10":((83,207,757,804,991,1001,1002,1360,),(7,19,43,210,300,572,666,674,705,728,787,880,909,1293,)),
"tng7x11":((464,970,1262,1467,1480,),(78,87,155,180,344,358,379,433,448,572,597,617,618,951,1035,1167,)),
"tng7x12":((100,223,313,363,396,647,680,720,906,976,991,1047,1309,),(87,131,340,379,432,596,617,669,700,781,1017,1022,1141,1144,1219,)),
"tng7x13":((27,111,161,197,210,363,394,397,674,906,953,980,1075,1170,1418,),(41,43,60,78,84,87,237,275,330,377,413,516,521,572,714,742,842,966,1022,1343,)),
"tng7x14":((295,464,556,569,632,639,744,989,1240,),(407,455,552,553,572,651,724,828,885,1116,1138,1416,1524,)),
"tng7x15":((212,294,310,433,448,836,991,1059,1223,),(87,176,223,291,301,325,363,395,411,521,572,669,1017,1138,1156,1219,1526,)),
"tng7x16":((7,83,247,343,397,680,890,953,1214,1219,1223,1235,1284,1309,1325,1332,),(87,136,155,184,478,482,521,572,588,751,766,799,891,947,1022,1238,1418,1520,)),
"tng7x17":((66,69,382,457,464,942,1109,1124,1175,1176,1198,),(317,358,420,762,1015,1043,1343,1416,)),
"tng7x18":((84,226,283,288,357,556,664,973,991,1158,1369,1518,),(291,301,572,724,770,1047,1403,1416,)),
"tng7x19":((336,1263,1464,1478,),(83,84,280,436,482,483,521,614,620,724,739,978,1194,1416,1518,)),
"tng7x20":((49,114,366,394,519,682,757,790,804,1052,1152,1185,1223,1226,1241,1288,1305,1368,1373,1413,1421,1449,),(48,87,210,223,268,325,420,674,772,800,893,899,951,966,991,996,1020,1065,1083,1119,1183,1191,)),
"tng7x21":((136,183,184,186,197,479,481,597,891,1047,1219,1264,1288,1368,1446,1528,),(66,78,87,297,380,484,572,699,893,989,1022,1080,1356,1418,)),
"tng7x22":((237,455,479,700,733,832,891,1001,1131,1180,1222,1412,),(40,43,49,125,155,210,244,363,547,600,674,706,757,804,883,893,899,961,970,989,1081,1167,1256,1416,1418,1518,)),
"tng7x23":((7,9,412,457,464,1061,1418,),(45,103,1052,1176,1329,1416,)),
"tng7x24":((116,136,137,191,193,341,396,427,433,448,719,991,1152,1195,1196,1413,),(84,271,572,576,772,813,899,1017,1191,1383,1524,)),
"tng7x25":((66,284,532,720,970,1170,1356,1370,1383,1384,1385,1480,),(29,38,48,92,97,176,363,441,521,597,980,1191,1299,)),
"tos0x01":((113,358,424,430,463,740,901,1188,1284,1287,1438,1516,),(171,180,190,234,256,262,283,305,321,361,453,495,521,618,664,705,724,736,754,887,997,1025,1047,1190,1294,1451,1472,1504,)),
"tos1x01":((42,279,446,453,455,460,532,601,613,944,1031,1257,1290,1449,1451,),(87,97,179,211,534,536,554,704,720,939,951,1187,1369,1450,1518,)),
"tos1x02":((70,96,315,368,455,460,778,),(97,155,179,197,326,358,380,482,531,600,651,674,680,720,730,973,1047,1194,1309,1332,1511,1518,)),
"tos1x03":((89,125,356,498,667,724,731,903,1053,1056,1224,1256,1303,1310,1382,1410,1468,1498,),(43,84,107,307,407,500,647,664,705,760,770,950,967,997,1045,)),
"tos1x04":((465,521,680,860,909,973,1053,1269,1305,1309,1433,1459,1518,),(43,78,210,279,281,305,308,363,376,482,564,590,617,724,738,742,773,893,1022,1091,1190,1194,1301,1386,1416,)),
"tos1x05":((276,353,416,516,618,677,829,838,1063,1072,1287,),(28,84,87,99,294,358,572,713,882,950,979,1169,1206,1235,1416,)),
"tos1x06":((213,456,457,590,656,1091,1477,2128,),(169,292,305,308,349,357,358,377,641,666,935,973,1011,1059,1071,1194,1356,1403,1511,1518,)),
"tos1x07":((42,49,136,197,243,283,460,505,575,700,856,944,1017,1134,1264,1298,1403,1449,),(66,184,187,210,308,321,371,600,632,674,686,724,893,951,973,1020,1034,1095,1139,1365,1518,)),
"tos1x08":((427,432,455,782,812,998,1141,1245,),(48,97,139,293,362,376,417,500,502,572,617,629,666,686,760,773,922,947,951,971,995,1011,1047,1093,1217,1247,1338,1416,1520,)),
"tos1x09":((83,105,166,613,618,728,829,838,909,1010,1311,),(393,400,410,664,666,814,930,1002,1066,1167,1223,1423,1459,)),
"tos1x10":((41,527,701,783,832,833,1379,1396,),(262,321,356,376,471,521,705,837,905,997,1022,1034,1194,1305,1386,1518,)),
"tos1x11":((89,182,184,340,746,748,1403,1485,),(87,97,180,209,210,315,363,521,664,674,893,1059,1264,1311,1336,1383,1390,1478,1498,1511,)),
"tos1x12":((28,223,268,428,577,991,1147,1222,1235,1296,),(41,45,84,155,210,256,321,379,450,478,503,511,572,617,700,704,773,779,891,979,1022,1218,1329,1416,1424,1518,)),
"tos1x13":((176,197,358,397,599,680,704,720,742,906,1150,1214,1235,1309,1510,),(87,179,210,294,376,521,533,557,572,651,721,898,968,1011,1286,1332,)),
"tos1x14":((467,472,577,664,700,720,832,833,915,995,1222,1465,1518,),(9,210,297,397,453,455,471,478,572,585,647,674,684,728,838,904,1106,1313,1451,)),
"tos1x15":((137,234,397,429,720,1023,),(41,168,169,279,361,684,796,802,1035,1299,1383,)),
"tos1x16":((113,234,358,361,424,430,463,720,740,901,1023,1188,1438,1516,),(168,171,180,190,210,256,283,305,321,453,495,521,547,639,664,674,705,724,796,997,1047,1284,1294,1299,1451,)),
"tos1x17":((317,590,729,741,829,1167,1484,),(41,87,276,294,305,380,407,511,535,572,600,651,666,724,838,926,929,970,1139,1210,1222,1291,1294,)),
"tos1x18":((66,187,243,358,455,906,1134,1242,1264,1284,1370,),(49,84,87,183,321,420,453,479,600,651,666,804,932,951,973,1016,1022,1034,1059,1133,1140,1222,1410,1451,1518,)),
"tos1x19":((53,158,195,325,358,417,453,455,617,686,730,773,994,1069,1222,1358,1372,1373,1428,1451,1501,1518,),(63,69,97,210,488,593,631,641,780,1022,1065,1215,)),
"tos1x20":((455,700,832,833,874,876,905,1008,1032,1222,1454,1459,1518,),(205,350,973,1170,1323,1356,1386,1416,)),
"tos1x21":((535,719,890,1356,1357,1440,1469,),(48,78,87,275,363,499,513,514,758,851,895,1011,1213,1366,1386,)),
"tos1x22":((623,725,746,853,1010,1061,1235,1241,1290,1295,1363,),(7,27,60,151,173,314,325,407,482,752,866,973,986,1065,1279,1343,1436,1478,1518,2128,)),
"tos1x23":((69,71,195,216,369,427,588,895,984,1235,1241,1245,1430,),(87,197,213,232,266,363,367,376,378,578,663,906,981,1011,1050,1091,1416,1423,1424,)),
"tos1x24":((428,455,457,613,639,750,890,951,1053,1204,1257,1476,1498,),(48,137,158,322,323,398,410,419,439,499,561,600,651,680,720,724,730,735,773,779,853,872,973,1021,1022,1040,1065,1089,1171,1309,1392,1410,1518,)),
"tos1x25":((151,590,639,658,666,720,746,819,820,1091,1101,1132,1284,1403,1568,2129,),(30,84,89,114,180,213,308,318,361,363,376,488,521,532,564,733,838,973,991,1050,1065,1119,1173,1183,1305,1478,1518,)),
"tos1x26":((125,325,366,416,969,1063,1077,1169,1260,1519,),(43,66,115,133,134,376,482,572,674,751,807,973,1011,1119,1386,1416,1491,)),
"tos1x27":((27,63,69,112,113,195,219,321,369,459,628,674,686,779,850,865,893,1022,1245,1370,1372,1392,1428,1501,1518,1528,),(84,93,210,213,325,363,376,379,487,502,521,547,576,600,617,629,785,906,998,1065,1091,1101,1191,1257,1345,)),
"tos1x28":((359,406,535,865,1254,1354,1356,1357,1369,1429,1469,),(97,210,296,350,407,477,504,547,572,600,641,666,674,905,906,1440,1487,)),
"tos1x29":((591,658,691,822,1033,1059,1214,1235,1344,),(97,161,234,267,268,270,299,363,521,522,572,973,991,1047,1337,1394,1518,)),
"tos2x01":((444,464,744,762,945,1039,1194,1282,1283,1328,),(66,126,414,511,590,647,651,717,724,997,1177,1403,)),
"tos2x02":((137,463,496,499,516,632,705,740,795,834,1173,1237,1284,1290,1458,),(48,66,89,171,279,358,376,535,579,633,802,859,890,1024,1275,1351,1398,1504,)),
"tos2x03":((60,66,314,325,369,455,596,597,647,951,1021,1374,1528,),(87,137,195,210,436,482,492,572,591,593,618,629,674,700,757,804,859,885,894,973,1013,1029,1222,1309,)),
"tos2x04":((137,398,460,601,639,719,942,951,1110,1199,1200,1225,1237,),(14,210,240,283,407,420,498,590,600,664,713,724,736,773,893,973,1065,1167,1204,1410,1498,1518,)),
"tos2x05":((60,102,325,397,453,500,532,733,991,1071,1393,1451,1568,),(210,279,333,407,411,572,664,718,721,724,1022,1065,1167,1288,1368,1403,2129,)),
"tos2x06":((120,169,303,355,389,572,741,832,1027,1221,1513,),(84,87,197,232,399,488,510,591,720,721,814,896,906,1194,1252,)),
"tos2x07":((21,135,445,455,464,467,577,738,959,960,1047,1465,2036,),(97,168,210,221,230,300,321,397,511,525,527,572,590,600,618,664,666,674,684,688,724,785,794,848,973,1044,1065,1091,1167,1194,1335,1371,1497,1500,1518,)),
"tos2x08":((7,460,741,1010,1061,1064,1170,1495,),(93,97,258,455,499,572,651,681,732,811,814,1167,1462,1506,2040,)),
"tos2x09":((27,35,113,552,553,725,741,824,853,1061,1101,1284,1290,1295,),(60,97,184,197,301,399,505,511,524,572,583,600,625,674,724,814,895,953,958,984,1000,1047,1059,1065,1275,1416,1525,)),
"tos2x10":((195,365,628,629,779,865,876,1021,1257,1269,1358,1392,1475,),(54,78,119,131,210,262,267,321,482,639,647,666,671,674,700,724,738,868,940,973,1022,1034,1403,1416,1518,)),
"tos2x11":((232,246,284,352,397,432,532,686,975,1150,1321,1347,),(84,87,97,291,301,482,572,618,639,684,839,913,914,995,1015,1212,1299,1524,)),
"tos2x12":((7,83,129,146,356,463,590,686,725,728,740,741,819,853,1284,1285,1290,1295,1406,),(23,87,197,203,204,242,387,420,528,618,724,814,936,984,985,997,1066,1095,1159,1163,1224,1311,1342,)),
"tos2x13":((187,197,253,369,658,739,1160,1374,1381,1528,),(87,125,169,368,376,380,564,712,720,1091,1139,1211,1266,1416,1498,1518,)),
"tos2x14":((27,195,215,311,399,453,587,850,1115,1392,1451,1488,),(15,48,97,314,321,365,376,455,530,629,646,724,733,853,865,875,942,998,1022,1034,1085,1203,1518,)),
"tos2x15":((325,363,396,479,481,487,503,653,891,980,1024,1373,),(84,185,210,240,241,244,318,411,425,577,618,714,757,795,804,880,899,940,1065,1153,1191,1393,1416,1518,)),
"tos2x16":((27,193,215,394,629,824,865,1373,1528,),(77,125,407,439,452,493,532,572,617,618,664,674,713,724,739,808,953,1065,1070,1256,1257,1259,1518,)),
"tos2x17":((37,375,453,463,639,704,740,884,1085,1290,1370,1451,),(65,197,210,321,420,521,539,582,619,724,869,953,1025,1091,1194,1332,1397,)),
"tos2x18":((132,232,455,691,704,832,983,991,1047,1222,),(28,84,87,97,291,294,301,309,380,397,531,542,572,720,772,782,899,915,1214,1221,1235,1323,1383,1387,1416,1518,)),
"tos2x19":((118,558,),(28,48,87,97,174,197,292,363,440,521,651,1005,1013,1059,1235,1246,1332,1452,1511,)),
"tos2x20":((27,125,231,561,1120,1256,1257,),(84,101,380,535,625,1013,1021,1022,1518,)),
"tos2x21":((414,457,459,628,629,760,809,945,1271,1282,1392,2129,),(87,97,233,301,439,511,536,547,564,590,651,652,664,680,713,721,724,812,877,896,926,930,973,998,1009,1055,1065,1217,1309,1518,1568,2128,)),
"tos2x22":((42,64,137,356,460,944,1011,1311,1370,1386,1430,),(83,210,211,231,294,321,420,422,455,498,600,601,617,618,632,651,666,674,738,966,991,997,1022,1035,1065,1169,1245,1351,1403,1410,)),
"tos2x23":((25,27,394,427,477,561,629,779,850,944,947,971,1022,1112,1114,1363,),(48,306,321,351,551,572,576,586,622,767,865,897,911,1034,1257,1308,1392,1393,1395,1416,1518,)),
"tos2x24":((8,197,307,457,728,732,741,832,833,1061,1279,1508,1832,2045,2046,),(48,87,90,91,97,363,572,651,666,727,782,906,951,991,995,1050,1052,1235,1298,1340,1416,1687,)),
"tos2x25":((27,89,125,144,195,399,895,1107,1117,1256,1311,),(86,303,603,748,1065,1331,1430,)),
"tos2x26":((65,86,100,425,704,852,1170,1356,1386,),(57,68,87,97,152,231,559,726,1045,1061,1161,1167,1186,1244,1424,)),
"tos3x01":((325,535,663,1188,1250,1305,1520,1521,),(97,291,294,301,358,407,453,502,510,572,639,641,730,1022,1336,1337,1451,1458,1525,)),
"tos3x02":((75,102,169,187,195,243,275,325,410,427,639,686,764,951,966,980,981,1172,1305,1448,),(43,84,87,137,197,398,600,664,674,687,724,859,973,1059,1134,1178,1410,1430,1518,)),
"tos3x03":((110,247,639,819,824,953,1113,1214,1235,),(93,108,109,136,197,236,293,358,407,572,618,651,664,678,713,724,814,834,973,1011,1037,1047,1065,1070,1191,1324,1326,1341,1369,1403,1416,1518,)),
"tos3x04":((100,137,368,432,559,720,782,1141,1385,1403,1504,),(93,97,232,380,455,597,647,669,724,730,781,818,1055,1217,2031,)),
"tos3x05":((182,297,340,457,466,482,556,572,632,637,700,738,1240,1269,),(87,184,210,243,246,321,455,498,514,674,893,1022,1194,1264,1416,1480,1518,)),
"tos3x06":((67,157,571,758,854,1061,1457,),(87,241,267,342,437,532,621,660,759,867,938,992,1023,1065,1167,1316,1332,)),
"tos3x07":((234,431,632,664,707,860,1188,1320,1491,1496,1516,),(33,179,180,210,259,283,379,386,457,536,572,674,705,724,834,951,966,973,979,1047,1065,1103,1275,1292,1302,1346,1403,1437,1518,)),
"tos3x08":((28,65,195,210,211,321,415,668,740,1022,1023,1159,1214,1235,),(57,93,262,376,527,698,877,1035,1163,1170,1194,)),
"tos3x09":((197,291,294,532,680,720,876,980,1036,1150,1309,1510,),(69,84,93,179,369,743,827,906,970,1046,1167,1249,1350,)),
"tos3x10":((37,244,500,524,639,682,809,986,1152,1239,1307,1343,2047,),(27,43,63,210,241,651,674,899,908,1035,1061,1159,1163,1332,)),
"tos3x11":((112,135,231,325,417,427,457,588,632,665,813,966,971,973,1386,1455,1518,1528,2129,),(267,527,618,700,724,762,773,782,868,893,895,995,1214,1222,1235,1412,1416,)),
"tos3x12":((26,96,163,195,234,374,411,419,428,566,601,680,773,790,850,893,944,951,1021,1053,1110,1139,1187,1257,1449,),(68,84,87,89,136,173,210,281,321,346,379,413,547,590,597,617,674,730,738,795,899,973,993,1022,1034,1036,1091,1222,1290,1300,1325,1466,1518,1568,2129,)),
"tos3x13":((358,417,457,571,639,664,1169,1355,1439,1453,1687,),(301,517,572,713,720,724,753,973,1416,1498,1518,)),
"tos3x14":((82,83,106,394,455,464,705,873,991,1061,),(87,97,291,301,572,583,591,704,742,748,814,1332,1416,1474,)),
"tos3x15":((75,140,427,521,686,700,764,832,833,850,971,1008,1022,1069,1098,1222,1430,1518,),(84,87,169,351,363,376,445,457,577,600,637,674,893,906,973,1055,1232,1305,1331,)),
"tos3x16":((350,455,740,768,770,832,959,960,1022,1073,1217,1222,1257,1380,1441,1518,),(48,155,262,321,358,551,601,664,701,724,738,951,973,1034,1035,1167,1258,1403,1410,1481,1498,)),
"tos3x17":((147,358,363,368,520,571,639,663,863,1029,1108,1289,1368,),(66,87,125,164,367,380,407,440,464,478,487,493,1059,1256,1416,1479,1521,)),
"tos3x18":((358,571,632,639,744,1524,),(87,93,94,97,203,210,240,380,397,521,534,666,899,909,970,985,1059,1091,1124,1398,1516,)),
"tos3x19":((139,193,195,198,341,346,427,438,512,646,850,1085,1098,1195,1196,1407,),(48,84,87,91,103,156,172,197,376,419,453,478,588,614,639,651,668,724,973,1065,1232,1386,1409,1451,1518,2062,)),
"tos3x20":((244,325,590,819,820,832,833,849,853,1091,1094,1121,1244,1307,),(87,219,222,380,394,457,600,647,651,661,666,674,714,821,838,888,906,916,980,1065,1290,1383,1385,1416,1526,)),
"tos3x21":((7,9,83,166,195,478,627,639,664,705,713,792,891,1052,1237,1287,1403,1460,1473,1503,1524,),(84,103,124,127,160,379,494,508,600,649,696,724,735,811,923,979,1014,1065,1066,1251,1458,1518,)),
"tos3x22":((63,66,69,362,453,680,782,865,1077,1269,1309,1332,1393,1451,1458,),(48,61,166,210,215,219,321,363,572,617,651,672,674,738,890,893,906,1017,1022,1028,1034,1060,1065,1167,1191,1351,1518,)),
"tos3x23":((639,705,1159,1170,1354,1356,1440,),(190,215,320,393,496,724,742,973,1023,1163,1231,1287,1411,1502,1518,1568,2129,)),
"tos3x24":((41,283,355,423,664,720,745,787,791,832,833,834,1067,1222,1223,1257,1444,2049,),(168,321,455,577,640,684,792,794,838,915,973,995,1022,1377,1384,1403,1518,)),
"voy1x01":((113,244,463,719,966,991,1058,1079,1295,1370,1440,1589,1660,),(27,65,84,137,305,564,591,618,651,717,1180,1504,1505,1577,1618,1630,1642,1780,2109,2115,2124,)),
"voy1x03":((197,464,491,743,951,966,1150,1510,1582,1679,1831,),(148,238,342,836,973,1298,1518,1568,1641,)),
"voy1x04":((27,334,403,1356,1659,1706,),(87,180,340,591,687,1094,1216,1694,1717,1745,1748,)),
"voy1x05":((241,244,873,1018,1686,1687,1709,),(286,437,664,927,1016,1587,1612,1637,1662,1829,)),
"voy1x06":((680,743,1180,1418,1510,1669,1756,),(305,486,509,733,927,950,1018,1070,1583,1610,1612,1723,)),
"voy1x07":((260,598,813,1078,1298,1440,1517,),(8,210,772,1356,1357,1639,1668,)),
"voy1x08":((577,618,639,724,1465,1524,1635,1636,1643,1675,),(155,168,600,688,754,772,922,1378,1692,1772,)),
"voy1x09":((207,239,319,429,740,1205,),(27,159,226,641,743,1070,1152,1167,1194,)),
"voy1x10":((27,555,590,600,997,1059,1180,1660,1682,1695,2070,),(137,180,380,581,639,666,696,1220,1512,1661,1704,1757,1760,)),
"voy1x11":((27,137,218,532,1018,1378,2097,),(160,362,639,761,930,1022,1047,1167,1416,1668,1701,)),
"voy1x12":((310,452,591,632,739,1018,1150,1418,1817,),(95,97,482,564,696,887,951,)),
"voy1x13":((457,464,632,691,1616,1703,),(197,241,335,828,1070,1294,1416,1418,1480,1516,1699,1711,)),
"voy1x14":((310,465,1433,1459,1591,1602,1687,1709,),(185,376,463,482,927,930,973,1403,1518,1612,1662,)),
"voy1x15":((86,132,241,244,281,314,980,991,1040,1221,1664,),(84,651,802,1011,1018,1245,1728,)),
"voy1x16":((680,720,1150,1298,1309,1634,1661,),(142,176,340,534,641,733,1025,1059,1418,1594,1741,1795,2064,)),
"voy2x01":((57,322,535,1458,1476,1504,1828,),(48,97,136,720,890,1119,1167,1383,1398,1572,1712,)),
"voy2x02":((37,49,310,319,898,1026,1528,1688,1689,1744,1776,),(260,314,742,1070,1284,1580,1700,1764,)),
"voy2x03":((342,350,355,1150,1278,1282,1283,1333,1386,1480,),(9,664,1018,1167,1383,1479,1786,)),
"voy2x04":((664,1293,1619,1628,1759,1878,),(84,564,743,809,899,1606,1697,1732,)),
"voy2x05":((235,359,500,532,1018,1469,1749,),(577,743,813,1512,1584,)),
"voy2x06":((66,464,743,1822,),(87,180,197,308,482,664,995,1167,1676,1677,1781,2095,)),
"voy2x07":((240,639,664,713,733,980,1018,1403,1609,),(511,742,886,899,994,1050,1180,1673,1793,)),
"voy2x08":((286,1150,1188,1294,1418,1604,1649,1650,1746,2064,),(87,267,380,407,479,618,736,1053,1403,)),
"voy2x09":((14,210,319,479,628,683,1070,1288,1599,1614,1739,1787,),(464,555,1250,1347,1769,2080,)),
"voy2x10":((65,136,601,997,1370,1449,1799,2119,),(651,730,773,991,1183,1222,1416,1516,1618,1735,1789,1796,)),
"voy2x11":((27,137,591,1047,1059,1222,1691,),(262,641,704,1071,1257,1412,1575,1655,)),
"voy2x12":((210,350,760,770,779,850,1693,2063,2090,),(262,310,369,1065,1360,1647,)),
"voy2x13":((9,137,741,1010,1169,1293,1402,1631,1668,1737,2045,2046,2062,2073,),(171,210,361,380,641,1569,1598,1680,1790,)),
"voy2x14":((27,96,215,338,369,427,850,1222,1386,1663,2112,),(137,294,326,366,572,1067,1378,)),
"voy2x15":((244,1464,1765,1775,),(137,601,699,1011,1378,1418,1612,1716,1761,1797,1816,)),
"voy2x16":((168,465,959,960,973,1250,1379,1518,1568,1581,1791,1799,2129,),(87,173,651,1222,1570,1725,1804,)),
"voy2x17":((86,732,991,1059,1402,1751,1832,2045,2046,2064,2125,),(137,197,436,1183,1378,1778,)),
"voy2x18":((113,168,420,853,941,1094,1237,1289,1370,1660,1684,1792,),(78,666,1167,1209,1244,1504,1597,1770,1802,)),
"voy2x19":((256,383,639,707,787,1418,1608,1633,1681,1685,1752,1813,),(84,137,232,283,380,441,534,666,1053,1091,1095,1183,1378,1611,1637,1712,)),
"voy2x20":((136,137,425,532,1059,1290,1378,1620,1652,1653,1683,),(87,1656,1698,1717,1775,)),
"voy2x21":((197,291,294,301,743,876,909,1029,1030,1459,1622,1644,1658,),(78,807,1153,1662,1709,1755,)),
"voy2x22":((319,340,466,739,819,1393,1568,1603,1645,1742,),(87,97,243,369,580,1205,1327,1520,1521,1600,1747,1771,1788,)),
"voy2x23":((454,466,482,672,1078,1079,1194,1788,1800,2064,2113,),(886,917,1505,1705,)),
"voy2x24":((615,713,909,1214,1615,1738,1810,1825,),(33,87,358,886,1210,1724,1767,)),
"voy2x25":((197,207,305,720,742,1011,1018,1023,1059,1150,1620,1690,),(43,361,380,1654,1722,1726,1754,)),
"voy2x26":((479,804,1058,1379,1386,1655,),(48,742,894,959,1070,1157,1209,1582,1593,1613,1629,1645,1718,1724,1726,1750,)),
"voy3x01":((319,457,591,742,953,1059,1150,1651,),(7,452,739,959,960,1668,1672,1803,)),
"voy3x02":((223,990,1271,1596,1607,1738,2071,2121,),(397,532,813,828,927,1166,1383,2078,)),
"voy3x03":((241,463,532,740,1379,1579,1605,1777,1819,2129,),(162,235,380,1196,1621,1624,1758,)),
"voy3x04":((9,284,631,1059,),(95,247,531,532,639,732,950,1707,1729,)),
"voy3x05":((27,125,438,523,953,986,1039,1239,1256,),(761,1517,2028,)),
"voy3x06":((478,516,519,551,615,850,1098,1184,1188,1601,1632,1664,1768,1783,),(84,380,407,511,565,819,886,898,1183,1715,1812,)),
"voy3x07":((241,470,588,1025,1785,2071,),(95,361,1070,1734,)),
"voy3x08":((513,535,1356,1469,),(125,504,1150,1167,1256,1257,1573,1714,1753,1782,1826,2081,2092,2108,)),
"voy3x09":((1356,1763,1773,2081,2092,2108,),(78,125,262,511,513,1256,1257,1357,1586,1588,1713,)),
"voy3x10":((590,779,1257,1311,1444,1449,1678,),(355,572,685,734,997,1022,1258,1377,1617,1730,1743,1820,)),
"voy3x11":((224,308,639,713,1774,1802,1808,),(78,590,601,705,951,1159,1163,)),
"voy3x12":((456,739,1807,),(666,1594,1657,)),
"voy3x13":((136,137,392,397,532,1180,1299,1660,1814,1953,2071,),(97,577,1223,1379,1627,1664,1696,1736,1809,)),
"voy3x14":((834,1052,1078,1287,1403,1623,1667,1740,),(380,457,664,705,713,743,899,980,1061,1210,1275,2064,)),
"voy3x15":((291,294,478,556,1205,1228,1353,1386,1471,1646,1818,),(244,361,429,572,1459,1578,1711,1762,1959,)),
"voy3x16":((283,333,411,453,713,724,1071,1185,1403,1451,1568,1623,1665,1806,2071,2129,),(84,119,180,197,386,664,958,997,1830,)),
"voy3x17":((136,381,1386,1671,),(80,97,301,1065,)),
"voy3x18":((465,639,714,1052,1219,1269,1832,2060,2120,),(33,136,262,321,380,800,1418,1458,1518,1946,2096,2099,2111,)),
"voy3x19":((110,228,640,1298,1309,2064,2069,2072,2076,2089,2116,),(48,509,680,686,704,1050,1052,1378,1668,2077,)),
"voy3x20":((129,146,180,590,600,714,724,740,997,1730,2084,2102,),(268,401,407,502,1047,1304,1464,2123,)),
"voy3x21":((246,247,284,618,1356,1731,2088,),(291,294,572,760,803,943,951,1418,1658,2086,)),
"voy3x22":((183,290,340,476,478,479,572,618,1219,1418,1648,1666,1702,),(49,162,241,244,511,743,803,804,880,1183,1185,1528,1590,1612,1640,)),
"voy3x23":((66,224,470,614,906,994,1288,1332,1585,1625,1695,1708,1719,1798,1827,2079,),(137,319,478,511,758,1331,1418,1720,1939,)),
"voy3x24":((146,457,463,464,715,1674,1821,),(84,950,1592,1638,)),
"voy3x25":((137,457,1418,1626,1710,1805,1815,2064,),(231,1022,1294,1794,2098,)),
"voy3x26":((460,665,1011,1386,1574,1779,),(48,97,241,317,332,433,815,1265,1418,1458,1571,1576,1595,1721,1731,)),
"voy4x01":((381,460,665,1386,1574,1779,),(86,176,332,395,601,815,)),
"voy4x02":((136,137,275,381,895,1274,1295,1449,1464,2061,2106,),(66,1299,1620,2110,)),
"voy4x03":((136,210,547,674,1288,1668,1740,2065,2066,2074,2087,2105,2107,),(60,119,325,532,705,871,991,1023,1592,1646,)),
"voy4x04":((112,417,427,576,585,636,1245,2068,2122,),(60,314,991,1205,1360,2083,2093,)),
"voy4x05":((7,9,136,427,639,728,792,947,960,1078,1258,1832,),(180,379,644,1018,1668,1833,1939,2074,2114,2126,)),
"voy4x06":((136,275,281,369,718,719,1426,1521,1601,),(482,930,1043,1265,1294,1571,1739,1786,)),
"voy4x07":((75,286,438,616,837,1030,1214,1235,1836,2034,),(176,363,1464,1510,1837,1838,1839,)),
"voy4x08":((358,460,601,832,1214,1840,1841,),(234,240,251,300,551,720,951,1345,1698,1721,)),
"voy4x09":((300,358,460,591,601,832,1059,1213,1214,1840,1841,),(47,169,197,217,234,991,)),
"voy4x10":((465,577,585,937,973,1188,1318,1516,1518,1842,1843,1844,),(84,240,511,701,769,785,1379,1845,1846,)),
"voy4x11":((7,1078,1125,1290,1332,1458,1571,1847,1848,),(48,78,91,155,1418,1849,)),
"voy4x12":((226,239,377,588,1205,1786,1850,),(78,294,340,803,930,989,1070,1095,1207,1299,1421,1426,1612,1771,1851,1852,1853,)),
"voy4x13":((72,457,1283,1854,1855,1856,1857,1858,),(273,411,1087,1183,1194,1859,)),
"voy4x14":((197,260,457,591,966,1078,1150,1510,1511,1615,),(432,598,950,1020,1612,1860,1861,)),
"voy4x15":((260,292,598,1615,1861,1862,1863,),(93,148,479,951,1220,1598,1617,1723,)),
"voy4x16":((176,210,211,773,853,932,1011,1574,1668,1863,1864,),(1653,)),
"voy4x17":((84,137,281,577,700,991,995,1166,1396,1465,1865,1866,1867,),(95,101,238,818,1868,1869,)),
"voy4x18":((457,459,932,1114,1395,1418,1863,1864,1870,1871,1872,),(103,453,788,1101,1451,1873,)),
"voy4x19":((224,457,459,932,971,1101,1114,1395,1418,1863,1864,1870,1871,1872,),(564,713,788,1018,1386,1528,1698,1874,1875,)),
"voy4x20":((1290,1295,1652,1876,1877,1878,1879,1880,),(564,715,724,951,1091,1712,)),
"voy4x21":((238,334,395,858,1011,1216,1332,1495,1881,),(27,78,651,669,781,1040,1450,)),
"voy4x22":((1018,1386,1521,1882,1883,),(535,769,941,1416,)),
"voy4x23":((551,588,971,1332,1465,1476,1884,2068,),(144,262,321,1022,1167,1615,1885,)),
"voy4x24":((358,742,1011,1053,1219,1886,),(75,240,517,733,1273,1292,1459,1887,1888,1889,)),
"voy4x25":((136,197,705,743,798,970,1150,1171,1287,1651,1890,),(97,267,482,1095,1194,1860,1891,)),
"voy4x26":((119,136,260,598,772,1222,1652,1862,1892,1893,),(97,158,1416,1598,)),
"voy5x01":((132,991,1519,1895,1896,1897,1898,1936,),(97,155,482,816,1221,1714,1899,)),
"voy5x02":((184,332,460,591,1059,1214,1274,1332,1687,),(97,291,572,640,1891,)),
"voy5x03":((226,354,420,572,991,1661,1862,1900,1901,1903,),(136,173,380,1165,1902,1904,)),
"voy5x04":((66,117,319,365,425,511,813,966,1905,),(86,180,651,704,724,1332,)),
"voy5x05":((240,803,989,1360,1646,1805,1852,1853,1906,),(97,1297,1767,)),
"voy5x06":((991,1011,1221,1356,1357,1901,),(93,1018,1167,1476,1659,2128,)),
"voy5x07":((86,144,235,1023,1607,1907,),(77,564,)),
"voy5x08":((112,616,645,879,947,949,971,1241,1418,1660,1908,1909,),(155,240,631,885,951,1298,1410,1422,)),
"voy5x09":((27,155,164,223,395,403,404,421,479,481,705,1890,1910,1911,1912,1913,1914,2049,),(106,347,452,532,739,814,1022,1403,1695,1714,1915,)),
"voy5x10":((137,639,813,850,947,971,1028,1386,),(345,511,886,941,951,1171,1517,1521,1723,)),
"voy5x11":((9,28,132,268,355,991,1698,1909,),(235,532,769,1167,1274,1279,1916,1917,1918,2103,)),
"voy5x12":((66,444,1403,1418,2064,),(137,535,1014,1714,1723,1919,)),
"voy5x13":((30,283,516,742,1185,1393,1403,1474,1568,1645,1740,),(705,1035,1165,1398,1615,1630,)),
"voy5x14":((340,399,464,598,739,1130,1463,1480,1615,1893,1920,),(93,484,832,833,1517,)),
"voy5x15":((136,204,223,332,381,460,721,832,833,945,997,1059,1739,),(119,183,380,478,618,651,782,803,1325,1332,)),
"voy5x17":((398,516,639,663,687,709,724,809,813,1241,1521,1763,1922,2118,),(407,941,1077,1138,1275,1395,1668,1921,1923,1924,)),
"voy5x18":((361,572,909,1297,1646,1925,1926,),(296,464,598,618,760,1687,1927,1928,)),
"voy5x19":((73,355,444,466,483,631,743,772,1059,1386,1788,1929,1930,1931,),(826,1070,1250,1421,1932,1933,2117,)),
"voy5x20":((338,934,1253,1284,1599,1934,),(1022,1935,)),
"voy5x21":((403,421,1059,1581,1897,1936,2064,),(84,556,680,950,973,1194,1222,1384,1452,1668,1937,)),
"voy5x22":((319,639,772,1095,1287,1403,1938,1939,),(233,308,326,441,564,724,886,1207,1518,2127,)),
"voy5x23":((114,819,1017,1018,1153,1288,1885,1941,1942,1943,1944,1945,1946,1951,),(210,479,1013,1080,1094,1947,1950,)),
"voy5x24":((1356,1357,1386,1948,),(169,620,951,995,1222,1459,1949,)),
"voy5x25":((86,457,1402,1751,1832,1952,1971,2045,2046,2064,),(9,160,280,1223,1257,)),
"voy5x26":((399,444,571,1063,1660,1664,1687,1840,1953,),(27,281,572,664,669,713,838,991,997,1013,1459,1891,1955,)),
"voy6x01":((395,399,444,832,1047,1050,1059,1063,1222,1388,1687,1953,1954,1955,),(27,668,785,838,957,1138,1459,)),
"voy6x02":((203,204,332,784,991,1189,1290,1437,1956,),(326,340,)),
"voy6x03":((223,470,588,597,803,1024,1205,1288,1957,1958,1959,),(530,1960,)),
"voy6x04":((424,1011,1150,1298,1649,1971,),(48,355,380,411,664,778,886,1318,)),
"voy6x05":((639,786,788,832,997,1961,1962,1963,2075,),(125,664,1018,1960,1964,)),
"voy6x06":((230,247,532,1393,1462,1521,1965,1966,1967,),(84,87,240,482,927,1332,1568,1968,)),
"voy6x07":((117,585,628,629,1047,1171,),(311,362,395,1022,1060,1476,)),
"voy6x08":((743,887,1332,1646,1970,),(1011,1969,1972,1984,)),
"voy6x09":((47,225,350,532,813,938,1384,1973,1974,),(451,1386,1975,)),
"voy6x10":((236,358,394,479,832,2049,),(424,532,641,754,861,1095,1414,1418,1598,)),
"voy6x11":((639,1078,1294,1418,1617,1976,1978,1979,2101,),(471,687,743,1191,)),
"voy6x12":((27,1355,1980,),(470,1076,1325,1332,1456,1573,2104,)),
"voy6x13":((192,398,601,686,811,886,933,1403,1410,1775,1981,1982,1983,1984,2085,),(9,1521,1620,1985,)),
"voy6x14":((47,112,281,991,1071,1245,1783,1986,),(87,497,737,814,1209,1960,)),
"voy6x15":((453,740,937,1023,1451,1687,1931,1932,1972,1987,1988,),(125,772,991,1071,1294,1776,1989,)),
"voy6x16":((49,144,203,204,209,340,454,1686,),(153,283,332,740,898,1022,)),
"voy6x17":((639,741,1078,1333,1418,1977,1978,1979,1990,),(9,318,1360,1991,)),
"voy6x18":((136,191,318,340,478,639,909,1464,1653,1992,1993,1994,2034,),(1043,1185,1386,1850,)),
"voy6x19":((119,136,144,191,479,575,757,804,1332,1593,1995,1996,),(97,359,991,1620,1997,)),
"voy6x20":((136,532,680,860,1309,1512,1653,1661,1998,1999,),(249,591,620,705,1053,1059,1095,1611,1633,1929,1983,2000,2001,)),
"voy6x21":((137,1465,2002,2003,),(48,210,1386,1991,)),
"voy6x22":((45,240,287,319,585,1039,1094,1110,1329,1645,2004,2005,),(664,1598,)),
"voy6x23":((136,279,464,532,1222,1356,1449,1518,2006,2007,),(970,1050,1459,1481,1709,1731,)),
"voy6x24":((197,241,244,280,732,733,951,1024,1418,1602,1646,1983,),(9,705,950,)),
"voy6x25":((457,464,482,556,632,1360,1788,2070,),(97,394,957,1240,)),
"voy6x26":((203,204,310,332,591,1079,1395,1952,),(119,424,706,838,1018,)),
"voy7x01":((194,203,204,332,706,838,1018,1079,1395,),(240,597,818,1022,)),
"voy7x02":((84,241,244,767,1023,1214,1223,1637,1646,2008,2009,),(43,273,386,699,913,1003,1205,1297,1620,1686,)),
"voy7x03":((212,500,639,1195,1403,1663,1960,1962,1972,2010,2011,2012,2013,),(664,)),
"voy7x04":((449,457,464,752,783,),(225,577,618,704,1049,1418,1703,1714,2014,2015,)),
"voy7x05":((33,164,555,725,1214,1241,2016,2018,),(668,1643,)),
"voy7x06":((125,137,287,832,1256,1383,1386,2019,),(639,1206,1617,1920,)),
"voy7x07":((7,8,29,564,588,639,740,951,1271,1282,1410,1568,1623,2129,),(38,308,511,713,1332,1806,2020,)),
"voy7x08":((232,394,601,680,1150,1223,1309,1668,),(308,618,1938,)),
"voy7x09":((9,136,740,850,932,1386,1601,1832,1863,1864,1871,1874,1954,2021,),(137,601,991,1022,1194,1208,1225,2100,)),
"voy7x11":((702,1356,1357,1469,),(294,454,1386,1403,1807,)),
"voy7x12":((185,436,478,618,1334,1531,1636,2023,2024,),(9,84,163,183,268,548,)),
"voy7x13":((168,210,959,960,971,991,1050,1465,2025,2026,2027,2036,),(281,454,517,684,955,1379,)),
"voy7x14":((470,597,774,986,1239,1528,1887,1981,2028,),(239,308,453,1451,1518,)),
"voy7x15":((678,743,813,1386,1440,1605,1687,2029,),(425,927,933,957,1232,2067,)),
"voy7x16":((639,740,769,1512,1986,),(197,1081,1403,1612,1633,2030,2031,)),
"voy7x17":((740,769,909,1018,1456,1512,1986,),(197,247,618,980,1386,1960,2031,2032,)),
"voy7x18":((398,424,639,687,886,1418,1806,1812,1938,1978,2033,2034,2035,),(380,436,511,927,1183,1617,)),
"voy7x19":((49,183,243,371,479,532,686,880,1023,1180,1185,1300,1365,1370,1853,),(171,481,1080,1360,1372,)),
"voy7x20":((7,8,9,467,696,1050,1418,1564,2037,2038,2094,),(478,684,763,850,880,1410,1698,)),
"voy7x21":((86,210,334,436,454,740,995,1083,1386,2039,2040,2041,),(291,301,572,618,680,1150,1573,)),
"voy7x22":((953,957,1645,1657,2036,2042,2091,),(686,814,824,1210,2043,2044,)),
"voy7x23":((114,136,502,519,996,1053,1924,2047,2048,),(300,340,369,379,572,639,680,804,1150,1620,1966,)),
"voy7x24":((397,454,720,741,),(125,232,308,411,436,618,740,886,895,951,1050,1138,1423,2050,)),
"voy7x25":((260,294,399,532,591,639,720,837,1011,1029,1241,1356,1357,2049,),(235,279,284,436,505,618,788,1459,1517,1617,1620,1658,)),        
        }

            


#the ontology tree
PARENT_NODE=(
None,0,0,0,0,793,73,1415,949,615,831,316,316,1142,316,855,1361,756,1361,1361,373,316,1361,1361,793,1100,1405,1097,907,55,
1209,892,1361,765,573,855,475,657,1361,889,881,227,227,924,690,1236,227,892,924,574,690,881,199,1208,501,604,1361,316,447,
793,1415,316,316,1415,316,1162,1415,328,316,328,145,328,316,831,4,1415,4,373,924,606,1100,1096,10,10,1401,1041,747,1401,606,
608,1432,227,73,924,501,1146,693,1401,892,1041,1427,1427,889,1236,1236,608,756,1499,1361,756,518,518,1427,747,610,610,610,447,
447,447,447,447,447,1415,10,337,402,924,1361,693,693,737,657,1415,642,879,573,845,693,227,145,771,501,608,1427,830,461,889,1499,
642,574,924,497,845,1208,1401,518,608,1208,690,1208,475,475,227,227,1236,776,402,889,610,1432,910,1100,657,1361,855,573,1,402,
461,589,227,227,881,1415,574,574,370,145,615,55,690,690,907,1427,426,845,845,949,1230,747,370,1499,10,771,518,461,657,957,227,
79,907,573,370,845,907,10,1361,907,319,319,364,227,657,1096,316,690,388,88,573,461,845,282,248,248,248,248,274,282,248,264,248,
282,282,248,177,248,248,245,282,282,282,282,282,282,282,248,264,264,285,285,285,264,248,245,245,285,248,285,274,285,285,245,248,
245,285,274,248,274,272,274,248,245,285,248,245,245,286,265,248,265,265,265,265,265,265,265,265,265,265,265,265,265,265,265,286,
248,274,282,1361,55,55,55,1427,370,286,1229,55,1019,650,615,370,608,889,643,319,319,227,830,328,1146,881,643,145,747,1499,608,607,
690,907,881,364,910,1361,756,1208,615,272,892,892,1415,573,1146,747,892,892,907,1401,1146,1164,907,924,370,589,1375,364,364,364,
364,364,604,881,657,797,227,1162,1401,657,501,55,924,1096,855,1019,765,765,765,756,2,747,501,892,227,786,218,218,218,218,218,218,
518,373,830,46,747,1041,227,924,1499,643,227,1401,10,1146,771,771,227,1415,1130,1100,1146,227,1018,1209,1146,1208,199,227,889,889,
747,693,328,328,657,76,881,765,615,1019,1361,845,608,793,1162,364,373,435,328,227,608,461,1168,1168,461,1168,461,461,177,1168,1168,
458,461,461,461,657,461,461,55,845,855,1019,845,1427,708,476,1099,1100,475,475,574,881,1401,1401,1401,855,1401,1100,1146,1146,402,
845,497,497,1209,497,497,543,497,497,475,831,910,474,1236,1019,1208,402,977,845,1208,1019,756,316,501,1019,1018,501,435,615,889,55,
474,227,1096,1432,1405,615,889,615,615,286,845,1208,1401,1415,1499,1162,747,227,1499,642,643,388,145,1361,1361,589,1041,1405,608,
1427,756,1041,1361,657,1164,402,1130,1209,501,1100,518,1499,337,227,907,79,328,475,907,1097,1401,1099,476,475,1208,1097,364,1499,
1499,1499,1499,501,501,693,609,657,657,607,370,55,145,1208,657,690,55,55,924,910,55,370,963,1361,611,786,611,611,831,199,963,1,963,
1405,1361,1408,765,589,475,1499,892,518,1208,693,574,370,501,316,1427,1100,615,957,1162,1415,447,227,227,227,1361,1018,88,55,830,
830,55,402,1100,55,881,1432,2,924,1499,364,756,845,892,1099,447,879,1142,370,776,1100,337,364,924,1432,1097,573,1405,501,615,272,
589,1208,1405,657,957,1164,573,957,690,574,227,2020,657,1019,977,690,1364,879,501,963,501,1361,1236,1130,1432,286,1401,889,73,1361,
910,1401,1019,949,924,1018,609,609,474,1019,690,1019,79,716,716,716,716,716,716,716,337,1405,977,1041,227,756,79,227,475,845,2020,
737,737,543,370,1168,1168,1168,1168,1168,1168,1209,1168,435,747,889,737,573,786,518,475,1405,831,474,1100,1096,474,501,501,881,364,
1408,1041,765,1146,786,892,830,475,79,855,328,199,793,1208,1100,1097,1208,1208,786,786,786,831,786,786,756,615,1146,1146,830,1146,
889,608,1230,892,1164,1146,518,88,475,475,1209,881,881,793,1142,574,1236,845,845,1162,1041,46,1499,573,1432,1405,227,879,1499,1405,
1361,73,1361,924,1018,4,4,1146,1146,1018,1499,573,1019,1019,1019,1018,1019,1164,881,1164,1099,227,642,889,227,227,1361,1427,1096,
227,1229,574,227,747,1209,461,461,461,747,747,1432,855,501,501,501,501,501,1236,518,1499,1499,1499,501,879,830,881,476,602,602,602,
602,602,602,46,388,1415,474,1146,589,1100,1432,573,1041,573,1401,609,227,845,889,227,892,55,1364,690,776,1364,373,957,79,1019,845,
1361,518,756,402,474,889,1208,907,607,612,612,612,612,612,612,612,612,612,612,612,612,612,608,1236,1208,364,855,461,609,328,1097,88,
949,227,370,337,1361,1415,756,615,1427,650,370,227,892,1499,771,1,690,690,845,1164,1499,475,657,949,447,1401,1361,608,657,831,373,370,
845,364,1499,1427,747,693,1100,227,1146,657,657,1401,608,657,402,88,690,461,79,855,608,881,1019,845,1499,73,73,1236,370,518,747,910,957,
845,10,1499,1499,574,708,845,370,1100,370,1058,1058,1058,1058,1058,1058,1058,1058,907,1058,1058,370,1401,907,907,907,1415,1097,797,1208,
1236,1164,977,845,657,1208,1096,657,1146,657,657,657,1208,657,501,458,1058,957,10,643,615,10,924,10,1209,949,1415,1164,1401,793,608,881,
574,855,643,10,501,881,881,518,889,475,889,747,892,1208,1142,643,337,402,1208,46,573,1408,1408,227,1,1408,227,1361,608,501,474,977,1128,
1128,1128,1128,1128,1128,1128,1128,1128,1128,1128,1499,756,1128,1128,1130,1128,756,1128,1128,1130,830,1130,830,771,1130,1361,574,373,518,
1236,461,461,1499,1142,831,1142,1142,501,611,227,1499,756,657,518,272,370,879,892,845,1427,227,518,977,501,830,1499,1229,892,892,924,458,
1168,1168,608,657,1361,145,328,957,1164,1860,501,657,218,1236,370,1019,574,977,1164,771,771,501,589,756,1041,1401,1427,1415,1208,855,855,
316,855,316,855,609,855,609,609,1230,543,612,1362,573,1361,907,1362,227,602,602,602,602,602,602,602,602,602,602,855,316,3,3,889,1097,855,
426,426,1230,693,373,855,316,1097,1415,1361,889,1427,609,1208,693,573,609,612,1097,907,907,1361,602,602,227,1362,889,889,1499,609,609,776,
52,609,609,426,609,609,609,609,609,609,776,609,776,776,609,52,609,609,610,610,610,610,610,227,610,610,610,610,610,610,610,610,610,610,610,
610,610,1361,1164,1164,227,855,609,609,497,602,609,1097,615,1097,615,615,615,615,227,227,227,1361,1362,1361,1361,855,1164,1236,1361,1361,
602,776,889,1361,1361,1361,1361,609,1362,1362,1236,1100,693,693,693,693,693,573,642,690,1499,73,73,73,73,1097,907,910,907,797,797,1100,177,
910,501,690,1432,1018,1162,1361,1415,1427,1427,2,892,889,1427,889,889,793,693,924,845,573,910,910,657,1432,1499,573,1096,771,475,46,765,615,
501,574,881,607,747,1018,957,76,1405,1405,2,227,337,1432,227,227,892,650,924,855,501,501,608,1164,765,501,977,518,1164,1375,1427,1427,747,
1427,963,693,1415,1443,1482,1482,1482,1482,1482,1482,1482,74,1443,1443,1482,1482,1482,1482,1482,1443,1443,1443,1482,1482,1482,1443,1443,
1443,1443,1443,1443,1443,1443,1443,1482,1443,1482,1443,1443,1482,1482,1482,1443,1443,1443,1486,1486,1482,1443,1443,74,1443,1486,1486,76,
1486,1486,1486,1486,52,426,776,776,52,693,737,497,831,319,1415,855,1146,1209,1019,497,615,889,881,573,573,573,756,1130,73,73,1499,337,907,
949,328,693,693,1019,1019,574,328,328,907,1142,574,693,1443,881,977,765,1482,747,1361,248,501,693,388,364,1427,1100,1097,1405,1208,1443,693,
1100,855,227,227,1096,765,610,227,227,615,573,896,573,881,1486,497,657,10,1362,1670,1362,1361,609,609,609,447,316,1405,1096,657,657,1164,977,
889,227,608,1041,10,881,657,370,608,1499,1142,879,227,573,690,574,907,657,657,657,1096,282,248,282,282,282,282,272,285,248,285,286,285,285,
274,274,248,265,274,501,227,1236,608,690,1208,1499,910,881,573,910,1019,476,1058,693,1361,1236,1361,328,1019,461,461,461,461,573,657,609,657,
690,573,690,889,227,957,881,776,907,573,501,1427,657,910,881,497,1058,1415,1236,1405,1362,609,328,786,1361,910,1209,227,370,573,501,1236,776,
1432,907,907,1432,1432,1432,1019,1019,889,737,1168,889,1361,765,1164,756,657,693,573,501,475,227,1236,1096,328,227,1164,612,602,612,602,602,
602,328,227,501,756,612,612,612,612,612,612,612,612,889,1164,881,924,1146,1164,889,643,609,657,657,1208,145,602,574,1019,1019,855,1058,1058,
608,10,690,1236,573,501,1130,501,756,1130,1058,1361,1146,1018,388,73,907,1361,73,609,1361,1164,227,227,881,602,602,602,690,693,957,609,316,
227,693,776,609,609,609,609,610,602,615,573,1146,1361,1361,227,1670,1486,609,316,957,476,227,501,501,879,447,573,693,501,657,1482,1443,1443,
1443,1443,1443,1443,1443,1443,1443,1486,1486,1443,1432,776,690,609,1209,573,227,609,892,892,1443,1499,282,1443,264,756,1486,1405,388,227,889,
657,388,1362,608,845,881,475,1164,771,609,1443,1164,609,573,756,274,328,1168,286,227,693,1361,1208,1872,1079,1670,1361,1443,1100,1443,657,737,
608,793,855,1443,771,227,1670,1072,282,282,737,285,892,910,693,771,1443,227,1427,227,892,248,892,615,892,924,364,881,892,765,765,227,274,1499,
610,889,756,612,776,609,501,693,227,248,793,1401,1443,910,690,1019,657,1208,612,227,1361,1168,573,227,501,657,609,282,227,756,690,690,274,610,
227,1443,1097,1670,1670,1058,227,657,889,765,1443,657,1443,1019,10,612,786,604,845,845,248,690,602,602,657,612,227,693,227,1482,1019,10,1670,
1670,285,693,282,609,282,786,889,1208,248,1164,282,1018,1443,1443,272,907,574,274,797,573,643,845,274,52,1100,657,610,285,657,364,737,497,1019,
1361,227,2017,76,1098,693,889,1097,892,285,482,1486,1361,1098,855,73,248,608,497,657,248,690,1097,227,657,1361,1361,1097,1097,889,282,227,10,
756,756,395,1209,1427,1100,2054,831,2056,1361,1209,612,609,1670,1443,1097,708,1168,274,1443,1097,1427,756,612,1168,747,1486,657,1142,1168,461,
1362,316,501,316,248,855,1443,328,475,708,1443,602,274,227,461,889,690,1164,1499,274,924,1209,892,1018,145,609,1164,1128,274,693,1168,1486,765,
1443,693,1443,892,501,690,475,1096,1486,693,1168,1427,1019,227,693,892,282,573,892,
        )

print("Number of themes in the ontology",len(set(PARENT_NODE)))
print("Number of relationships in the ontology",len(PARENT_NODE))

# creates a dictionary for themes containing the set of episodes where the theme occurs
EPISODES={}
for episode in EPISODE_THEMES:
    for i in (0,1):
        for theme in EPISODE_THEMES[episode][i]:
            theme=PARENT_NODE[theme]
            if theme in EPISODES:
                EPISODES[theme].add(episode)
            else:
                EPISODES[theme]=set([episode,])

        
# computes the IDFs for each theme
IDF={}
# first counts for each theme the number of stories where it is featured
for episode in EPISODE_THEMES:
    themes=set(EPISODE_THEMES[episode][0]+EPISODE_THEMES[episode][1])
    for theme in themes:
        theme=PARENT_NODE[theme]
        if theme in IDF:
            IDF[theme]+=1
        else:
            IDF[theme]=1
# computes idfs
for theme in IDF:
    IDF[theme]=math.log(1+len(EPISODE_THEMES)/IDF[theme])**0.1
print("Themes IDFs done!")
        
        
# evaluation benchmark
BM={
"BSS01":["Alien_overseer","tos2x17","tos2x26","tos3x08","tas2x02","tas2x05","tng1x08","voy1x01","voy2x10"],
"BSS02":["Betrayal","tos1x15","tos1x24","tos2x02","tos2x03","tos2x04","tos2x22","tos3x02","tos3x04","tng1x13","tng1x14","tng3x09","tng3x10","tng3x19","tng3x22","tng4x06","tng5x19","tng6x12","tng6x15","tng7x01","tng7x24","voy1x01","voy1x10","voy1x11","voy2x11","voy2x13","voy2x14","voy2x15","voy2x17","voy2x19","voy2x20","voy3x13","voy3x23","voy3x25","voy4x02","voy4x17","voy5x10","voy5x12","voy6x21","voy7x06","voy7x09"],
"BSS03":["Desire_for_vengeance ","tos1x12","tos1x14","tos1x17","tos1x18","tos1x19","tos1x20","tos2x03","tos2x18","tos3x11","tos3x12","tos3x15","tos3x16","tos3x24","tas1x08","tng1x09","tng1x16","tng3x03","tng3x09","tng3x13","tng3x14","tng3x17","tng4x07","tng4x12","tng5x04","tng6x15","tng6x26","tng7x22","voy2x10","voy2x11","voy2x14","voy4x26","voy5x21","voy6x01","voy6x23"],
"BSS04":["Father_and_son ","tos2x15","tas1x02","tng1x09","tng1x17","tng2x04","tng2x14","tng3x17","tng4x02","tng4x03","tng4x04","tng4x07","tng5x07","tng5x08","tng5x10","tng5x12","tng5x16","tng5x20","tng5x25","tng6x08","tng6x16","tng6x17","tng7x21","tng7x22","voy2x08","voy2x09","voy2x26","voy3x22","voy4x15","voy5x09","voy5x23","voy6x10","voy6x19","voy7x19"],
"BSS05":["Ferengi ","tng1x05","tng1x09","tng2x21","tng3x08","tng3x19","tng3x24","tng5x21","tng6x07","tng7x22","voy3x05","voy7x06"],
"BSS06":["Fight_to_the_death ","tos0x01","tos1x01","tos1x14","tos1x16","tos1x18","tos1x19","tos2x05","tos2x14","tos2x17","tos3x01","tos3x19","tos3x22","tng1x04","tng1x10","tng4x07","voy3x16","voy6x15","voy7x14"],
"BSS07":["Interfering_in_less_advanced_societies ","tos1x22","tos1x27","tos2x09","tos2x14","tos2x16","tos2x20","tos2x23","tos2x25","tos3x10","tng1x04","tng1x08","tng1x14","tng1x18","tng2x04","tng2x15","tng3x04","tng4x15","tng5x13","tng7x13","voy1x01","voy1x04","voy1x09","voy1x10","voy1x11","voy2x11","voy2x14","voy3x05","voy4x21","voy5x09","voy5x26","voy6x01","voy6x12"],
"BSS08":["Lust_for_gold ","tos1x03","tos2x16","tos2x20","tos2x25","tos3x17","tas1x10","tng1x05","tng1x12","tng1x22","tng1x26","tng2x21","tng3x08","tng3x14","tng3x19","tng3x22","tng4x13","tng5x09","tng5x21","tng6x07","tng6x18","tng7x22","voy3x05","voy3x08","voy3x09","voy7x06"],
"BSS09":["Man_against_captivity ","tos0x01","tos1x16","tos2x02","tos2x12","tos2x17","tos3x08","tos3x16","tas1x15","tas2x05","tng1x17","tng2x12","tng2x17","tng3x11","tng3x12","tng3x18","tng3x22","tng3x24","tng4x20","tng6x11","tng6x12","tng6x17","tng6x21","tng7x02","voy1x09","voy3x03","voy3x20","voy6x15","voy6x16","voy7x07","voy7x09","voy7x16","voy7x17","voy7x21","voy7x24"],
"BSS10":["Man_against_nature ","tos1x04","tos1x13","tos3x14","tos3x23","tas1x02","tas1x16","tas2x03","tng3x07","tng4x09","tng6x19","tng7x08","tng7x13","voy2x02","voy2x07","voy2x25","voy2x26","voy3x01","voy4x24","voy5x13"],
"BSS11":["Meet_one's_self ","tos1x04","tos1x09","tos1x20","tas1x02","tng2x13","tng6x24","voy1x14","voy2x21","voy3x15","voy4x24","voy5x24","voy5x26","voy6x01","voy7x25"],
"BSS12":["Mother_and_daughter ","tng1x11","tng1x17","tng2x19","tng3x24","tng4x22","tng5x20","tng7x07","voy3x21","voy3x22","voy4x12","voy5x05","voy5x15","voy6x03"],
"BSS13":["Newfound_magical_powers ","tos1x01","tos1x07","tos3x12","tas1x08","tng1x06","tng1x10","tng6x06","tng7x20","voy3x10","voy4x02"],
"BSS14":["Obsession ","tos1x10","tos1x14","tos1x20","tos2x06","tos2x18","tos2x24","tos3x15","tos3x16","tos3x20","tos3x24","tas1x07","tng1x09","tng1x18","tng2x19","tng3x01","tng3x09","tng3x24","tng4x12","tng4x21","tng5x04","tng5x25","tng6x09","tng6x22","tng7x09","tng7x22","voy4x08","voy4x09","voy5x14","voy5x15","voy6x01","voy6x05","voy6x10","voy7x06"],
"BSS15":["Quest_for_immortality ","tos1x09","tos1x11","tos2x12","tos2x22","tos2x25","tng1x16","tng1x26","tng2x06","voy3x10"],
"BSS16":["Physical_disability ","tos0x01","tos1x15","tos1x16","tos1x29","tos3x07","tos3x12","tng1x03","tng1x16","tng2x05","tng3x07","tng4x10","tng5x13","tng5x16","voy4x08","voy4x09"],
"BSS17":["Ship_takeover ","tos1x06","tos1x24","tos2x21","tos2x24","tos3x05","tos3x07","tos3x11","tos3x13","tos3x15","tos3x20","tng1x03","tng1x07","tng1x15","tng4x03","tng4x19","tng6x07","tng6x18","tng7x17","tng7x23","voy1x13","voy3x01","voy3x14","voy3x24","voy3x25","voy4x13","voy4x14","voy4x18","voy4x19","voy5x25","voy6x25","voy7x04"],
"BSS18":["Time_travel ","tos1x06","tos1x20","tos1x21","tos1x28","tos2x26","tos3x23","tas1x02","tng1x24","tng2x13","tng3x15","tng3x19","tng5x09","tng5x18","tng5x26","tng6x01","tng6x15","tng6x25","tng7x21","tng7x25","voy1x04","voy1x07","voy3x08","voy3x09","voy3x21","voy5x06","voy5x24","voy6x23","voy7x11","voy7x25"],
"BSS19":["Worf ","tng1x20","tng2x20","tng3x05","tng3x17","tng4x07","tng4x26","tng5x01","tng5x10","tng5x16","tng6x08","tng6x16","tng6x17","tng6x23","tng7x11"],
"BSS20":["Recreation_gone_wrong ","tos1x17","tas2x03","tng1x12","tng2x03","tng3x19","tng6x08","voy1x12","voy3x22","voy5x12","voy6x11","voy6x17"],
"BSS21":["Host_a_dignitary ","tos1x23","tos2x15","tos3x02","tos3x07","tng1x07","tng2x05","tng2x10","tng2x19","tng3x08","tng3x23","tng4x23","tng4x24","tng5x21","tng7x02","voy5x22"],
"BSS22":["Courtroom_drama ","tos1x14","tos1x16","tos1x18","tos2x07","tos3x24","tas1x08","tng1x01","tng1x08","tng2x09","tng3x14","tng3x17","tng4x13","tng4x21","tng5x19","voy1x08","voy2x18","voy7x19","voy7x20"],
"BSS23":["Diplomacy ","tos1x02","tos1x23","tos1x26","tos1x27","tos2x03","tos2x07","tos2x10","tos2x13","tos2x14","tos2x15","tos3x02","tos3x04","tos3x09","tos3x11","tos3x15","tos3x17","tos3x19","tas1x05","tas2x01","tng1x04","tng1x07","tng1x08","tng1x12","tng1x14","tng1x16","tng1x22","tng2x04","tng2x05","tng2x18","tng3x02","tng3x08","tng3x09","tng3x10","tng3x12","tng3x14","tng3x17","tng3x23","tng3x24","tng4x04","tng4x07","tng4x11","tng4x12","tng4x22","tng4x23","tng4x24","tng4x26","tng5x01","tng5x03","tng5x07","tng5x08","tng5x15","tng5x17","tng5x21","tng6x03","tng6x10","tng6x11","tng6x13","tng6x18","tng7x08","tng7x20","tng7x24","voy2x12","voy2x14","voy2x18","voy2x22","voy3x26","voy4x01","voy4x06","voy4x22","voy5x04","voy5x10","voy5x17","voy7x03","voy7x23"],
"BSS24":["Find_a_cure ","tos1x06","tos1x11","tos1x25","tos1x29","tos2x11","tos2x25","tos3x02","tos3x09","tos3x10","tos3x13","tos3x21","tas1x13","tas2x04","tng1x03","tng1x14","tng2x07","tng2x22","tng5x14","tng6x03","tng6x07","tng7x16","tng7x19","voy1x05","voy1x15","voy2x19","voy3x12","voy3x16","voy5x08","voy6x24","voy7x14"],
"BSS25":["Religiously_themed ","tos1x22","tos2x04","tos2x09","tos2x14","tos3x10","tos3x20","tos3x23","tas1x08","tas2x05","tng1x08","tng2x01","tng3x04","tng3x25","tng4x13","tng4x15","tng5x24","tng5x26","tng6x23","tng7x01","tng7x17","voy1x09","voy2x22","voy3x05","voy3x07","voy3x15","voy3x23","voy4x04","voy4x12","voy4x21","voy6x03","voy6x12","voy7x02","voy7x14"],
"BSS26":["Global_catastrophic_risk ","tos0x01","tos1x05","tos1x09","tos1x11","tos1x16","tos1x20","tos1x23","tos1x25","tos1x27","tos1x29","tos2x06","tos2x09","tos2x10","tos2x12","tos2x13","tos2x19","tos2x21","tos2x22","tos2x25","tos2x26","tos3x03","tos3x06","tos3x08","tos3x10","tos3x02","tos3x13","tos3x14","tos3x15","tos3x17","tos3x19","tos3x23","tas1x03","tas1x05","tas1x07","tas1x11","tas1x13","tas1x14","tas1x16","tas2x04","tng1x05","tng1x11","tng1x15","tng1x17","tng1x22","tng1x24","tng1x25","tng2x11","tng2x15","tng2x16","tng2x18","tng3x02","tng3x03","tng3x05","tng3x13","tng3x19","tng3x26","tng4x01","tng4x09","tng4x13","tng4x22","tng4x23","tng5x09","tng5x10","tng5x13","tng5x20","tng5x23","tng5x25","tng6x06","tng6x10","tng6x20","tng7x13","voy1x01","voy1x04","voy1x05","voy2x23","voy2x18","voy3x11","voy3x19","voy4x01","voy4x03","voy4x21","voy4x26","voy5x04","voy5x09","voy6x19","voy6x26","voy7x21"],
"BSS27":["Family_affairs ","tos0x01","tos1x03","tos1x05","tos1x07","tos1x08","tos1x09","tos1x11","tos1x12","tos1x14","tos1x18","tos1x26","tos1x29","tos2x03","tos2x05","tos2x07","tos2x08","tos2x11","tos2x12","tos2x15","tos2x16","tos2x18","tos2x22","tos2x24","tos3x02","tos3x03","tos3x05","tos3x10","tos3x11","tos3x17","tos3x19","tos3x20","tos3x21","tos3x22","tas1x02","tas1x06","tng1x01","tng1x03","tng1x04","tng1x06","tng1x07","tng1x08","tng1x09","tng1x10","tng1x11","tng1x13","tng1x14","tng1x16","tng1x17","tng1x19","tng1x24","tng1x26","tng2x01","tng2x04","tng2x08","tng2x10","tng2x14","tng2x15","tng2x18","tng2x19","tng2x20","tng3x01","tng3x03","tng3x04","tng3x05","tng3x12","tng3x14","tng3x16","tng3x17","tng3x23","tng3x24","tng4x02","tng4x03","tng4x04","tng4x05","tng4x06","tng4x07","tng4x08","tng4x09","tng4x11","tng4x14","tng4x22","tng4x25","tng4x26","tng5x01","tng5x04","tng5x05","tng5x06","tng5x07","tng5x08","tng5x10","tng5x11","tng5x12","tng5x15","tng5x16","tng5x19","tng5x20","tng5x22","tng5x25","tng6x04","tng6x05","tng6x06","tng6x07","tng6x08","tng6x13","tng6x15","tng6x16","tng6x17","tng6x20","tng6x24","tng7x01","tng7x03","tng7x06","tng7x07","tng7x09","tng7x10","tng7x11","tng7x12","tng7x13","tng7x14","tng7x15","tng7x16","tng7x19","tng7x20","tng7x21","tng7x22","tng7x24","voy1x01","voy1x04","voy1x07","voy1x08","voy1x14","voy1x16","voy2x02","voy2x04","voy2x05","voy2x08","voy2x09","voy2x17","voy2x21","voy2x22","voy2x23","voy2x26","voy3x01","voy3x03","voy3x04","voy3x06","voy3x11","voy3x15","voy3x16","voy3x21","voy3x22","voy3x23","voy4x12","voy4x15","voy4x26","voy5x05","voy5x09","voy5x13","voy5x14","voy5x15","voy5x18","voy5x19","voy5x22","voy5x23","voy6x02","voy6x03","voy6x10","voy6x15","voy6x16","voy6x18","voy6x19","voy6x24","voy7x03","voy7x04","voy7x08","voy7x12","voy7x16","voy7x17","voy7x18","voy7x19","voy7x20","voy7x21","voy7x23","voy7x24","voy7x25"],
"BSS28":["Tough_decision ","tos0x01","tos1x01","tos1x03","tos1x04","tos1x05","tos1x06","tos1x07","tos1x08","tos1x10","tos1x12","tos1x13","tos1x14","tos1x15","tos1x16","tos1x19","tos1x20","tos1x21","tos1x23","tos1x24","tos1x26","tos1x27","tos1x28","tos1x29","tos2x02","tos2x04","tos2x05","tos2x06","tos2x07","tos2x09","tos2x10","tos2x11","tos2x12","tos2x14","tos2x15","tos2x16","tos2x17","tos2x18","tos2x19","tos2x22","tos2x23","tos2x24","tos2x25","tos2x26","tos3x01","tos3x02","tos3x03","tos3x06","tos3x08","tos3x09","tos3x10","tos3x11","tos3x12","tos3x13","tos3x14","tos3x18","tos3x19","tos3x20","tos3x21","tos3x22","tos3x23","tos3x24","tas1x03","tas1x04","tas1x05","tas1x10","tas1x15","tas2x01","tng1x01","tng1x04","tng1x05","tng1x07","tng1x08","tng1x10","tng1x13","tng1x14","tng1x15","tng1x19","tng1x20","tng1x21","tng1x22","tng1x23","tng1x24","tng1x26","tng2x02","tng2x05","tng2x07","tng2x08","tng2x09","tng2x10","tng2x11","tng2x14","tng2x15","tng2x16","tng2x21","tng3x01","tng3x02","tng3x03","tng3x04","tng3x05","tng3x06","tng3x07","tng3x08","tng3x09","tng3x10","tng3x12","tng3x14","tng3x15","tng3x16","tng3x18","tng3x19","tng3x20","tng3x22","tng3x24","tng3x25","tng3x26","tng4x02","tng4x04","tng4x06","tng4x07","tng4x08","tng4x09","tng4x12","tng4x13","tng4x14","tng4x16","tng4x19","tng4x21","tng4x22","tng4x23","tng5x01","tng5x02","tng5x03","tng5x04","tng5x05","tng5x07","tng5x08","tng5x09","tng5x10","tng5x13","tng5x14","tng5x16","tng5x17","tng5x18","tng5x19","tng5x20","tng5x21","tng5x22","tng5x23","tng5x26","tng6x03","tng6x05","tng6x06","tng6x09","tng6x13","tng6x15","tng6x19","tng6x20","tng6x22","tng6x24","tng6x25","tng6x26","tng7x03","tng7x10","tng7x12","tng7x13","tng7x15","tng7x16","tng7x18","tng7x20","tng7x24","voy1x01","voy1x03","voy1x05","voy1x09","voy1x10","voy1x11","voy1x14","voy1x15","voy1x16","voy2x01","voy2x03","voy2x04","voy2x06","voy2x09","voy2x11","voy2x12","voy2x13","voy2x14","voy2x15","voy2x17","voy2x18","voy2x19","voy2x20","voy2x24","voy2x25","voy2x26","voy3x02","voy3x06","voy3x13","voy3x15","voy3x16","voy3x17","voy3x18","voy3x19","voy3x20","voy3x26","voy4x01","voy4x04","voy4x06","voy4x07","voy4x08","voy4x09","voy4x12","voy4x16","voy4x19","voy4x20","voy4x21","voy4x22","voy4x24","voy4x26","voy5x01","voy5x02","voy5x03","voy5x04","voy5x05","voy5x06","voy5x08","voy5x09","voy5x10","voy5x11","voy5x14","voy5x17","voy5x18","voy5x19","voy5x20","voy5x23","voy5x24","voy5x26","voy6x01","voy6x04","voy6x06","voy6x07","voy6x08","voy6x09","voy6x10","voy6x13","voy6x15","voy6x16","voy6x17","voy6x18","voy6x19","voy6x21","voy6x25","voy7x02","voy7x04","voy7x05","voy7x06","voy7x08","voy7x09","voy7x11","voy7x15","voy7x17","voy7x18","voy7x19","voy7x20","voy7x21","voy7x23","voy7x24","voy7x25"],
        }

# Black-listed themes
blacklist=(
1964, #age sensitivity
190, #chivalry
310, #courage
311, #courage in the face of death
312, #courtesy
317, #creativity
379, #distaste for attention
468, #fairness
521, #fortitude
591, #heroism
596, #honesty
600, #hospitality
641, #ingenuity
644, #inquisitiveness
647, #integrity
906, #personal conviction
29, #Spartan asceticism
1592, #bellicosity
187, #childishness
201, #closed-mindedness
213, #complacency
314, #cowardice
321, #cruelty
362, #deviousness
590, #hedonism
601, #hubris
625, #imitativeness
1680, #ingratitude
661, #irreverence
738, #malevolence
950, #prickliness
958, #prudishness
979, #reclusiveness
1008, #righteousness
1020, #rudeness
1022, #ruthlessness
1034, #sadism
#N/A ""self-love" not found in the ontology !!!!!
1153, #stubbornness
1183, #tardiness
43, #acceptance
48, #admiration
78, #amazement
93, #anticipation
127, #awe
151, #bliss
361, #determination
380, #distraction
407, #ecstasy
598, #hope
651, #interest
666, #joy
828, #nostalgia
2098, #pride in one's own creation
1733, #pride in ones own creation
1065, #serenity
1167, #surprise
1904, #the thrill of danger
1383, #trust
1416, #vigilance
84, #anger
87, #annoyance
97, #apprehension
155, #boredom
357, #despair
376, #disgust
411, #embarrassment
482, #fear   # WARNING: this is not a leaf node !!!! ERROR: blacklisted theme 482 is not a leaf node. It is an ancestor of theme 2024 in the path [2024, 482, 1401, 607, 611, 1, 0]
483, #fear for one's life
484, #fear of an unknown future
1924, #fear of strangers
486, #fear of the unknown
534, #frustration
572, #grief
700, #loathing
705, #loneliness
899, #pensiveness
973, #rage
991, #remorse
1035, #sadness
1071, #shame
1194, #terror
)
        
        
STORIES=list(EPISODE_THEMES.keys())
STORIES.sort()
sorted_story_sets_ids=list(BM.keys())
sorted_story_sets_ids.sort()


 

# computes the path to root for each theme
PATH_TO_ROOT=[]
for i in range(len(PARENT_NODE)):
    path=[i]
    j=i
    while PARENT_NODE[j]!=None:
        path.append(PARENT_NODE[j])
        j=PARENT_NODE[j]
    #print(i,path)
    PATH_TO_ROOT.append(path)

ontology_depth=max([len(x) for x in PATH_TO_ROOT])  # ontology depth
print("ontology depth",ontology_depth)



# verify blacklisted themes to be leaf nodes in the ontology
to_remove=[]
for blacklisted_theme in blacklist:
    for theme in range(len(PATH_TO_ROOT)):
        if blacklisted_theme!=theme:
            if blacklisted_theme in PATH_TO_ROOT[theme]:
                print("ERROR: blacklisted theme",blacklisted_theme,"is not a leaf node. It is an ancestor of theme",theme,"in the path",PATH_TO_ROOT[theme])
                to_remove.append(blacklisted_theme)
blacklist=set([t for t in blacklist if not t in to_remove])
#blacklist=set() # this line makes that no blacklisted theme be removed !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! plase comment it if you want the blacklisted themes be removed

# computes the probability of all themes
THEME_PROBABILITY=[0]*len(PARENT_NODE)
for story in STORIES:
    for theme in EPISODE_THEMES[story][0]+EPISODE_THEMES[story][1]:
        #THEME_PROBABILITY[theme]+=1
        for ancestor in PATH_TO_ROOT[theme]:
            THEME_PROBABILITY[ancestor]+=1

THEME_PROBABILITY=[x/THEME_PROBABILITY[0] for x in THEME_PROBABILITY]

#computes the summation of information content of a series of themes
def info(themes):
    return sum([-math.log(THEME_PROBABILITY[x]) for x in themes])

#gets the path length between two themes
def path_length(theme1,theme2):
    if theme1==theme2:
        path=0
    else:
        s1=set(PATH_TO_ROOT[theme1]) 
        s2=set(PATH_TO_ROOT[theme2])
        intersection=s1.intersection(s2)
        path=len(s1)+len(s2)-2*len(intersection)
    return path


"""
# determimne the longest path int he ontology  13!!!
print("max path ... ",end="")
max_path=0
for t1 in range(len(PARENT_NODE)):
    for t2 in range(len(PARENT_NODE)):
        p=path_length(t1,t2)
        if p>max_path:
            max_path=p
print(max_path)
"""


#gets the lowest common subsummer between two themes
def LCS(theme1,theme2):
    depth=-1
    for x,y in zip(PATH_TO_ROOT[theme1][::-1],PATH_TO_ROOT[theme2][::-1]):
        if x==y:
            lcs=x
            depth+=1
        else:
            break
    return (lcs,depth)







#theme similarity functions
def path(theme1,theme2):
    return 1/(path_length(theme1,theme2)+1)

def path1(theme1,theme2):
    #print("\t",theme1,theme2,path_length(theme1,theme2))
    return 1-(path_length(theme1,theme2)/13)

def lch(theme1,theme2):
    try:
        return -math.log(path_length(theme1,theme2)/(2*ontology_depth))/3
    except:
        print("Err")
        return 0

def wup(theme1,theme2):
    lcs,depth=LCS(theme1,theme2)
    try:
        return 2*depth/(len(PATH_TO_ROOT[theme1])+len(PATH_TO_ROOT[theme2]))
    except:
        print("Err")
        return 0

def res(theme1,theme2):
    #if theme1==theme2:
    #    return 1.0
    lcs,depth=LCS(theme1,theme2)
    return info([lcs])/10

def lin(theme1,theme2):
    lcs,depth=LCS(theme1,theme2)
    try:
        return 2*info([lcs])/(info([theme1])+info([theme2]))
    except:
        print("Err")
        return 0

def linc(theme1,theme2):
    lcs,depth=LCS(theme1,theme2)
    
    try:
        return info([lcs])/math.sqrt(info([theme1])*info([theme2]))
    except:
        print("Err",info([lcs]),info([theme1]),info([theme2]))
        return 0

def jcn(theme1,theme2):
    lcs,depth=LCS(theme1,theme2)
    try:
        return (1/(info([theme1])+info([theme2])-2*info([lcs])))/2
    except:
        print("Err")
        return 0

def cos(theme1,theme2):
    set1=EPISODES[theme1]
    set2=EPISODES[theme2]
    intersection=set1.intersection(set2)
    return len(intersection)/math.sqrt(len(set1)*len(set2))
    
def path_cos(theme1,theme2):
    return 0.5*(path(theme1,theme2)+cos(theme1,theme2))

def wup_cos(theme1,theme2):
    return 0.5*(wup(theme1,theme2)+cos(theme1,theme2))

def lin_cos(theme1,theme2):
    return 0.5*(lin(theme1,theme2)+cos(theme1,theme2))

def res_cos(theme1,theme2):
    return 0.5*(res(theme1,theme2)+cos(theme1,theme2))









# Soft Cardinality function
CACHE1={}
CACHE2={}
CACHE3={}
def SC(themes1,themes2,theme_sim,p=1,coef="cosine"):
    key1=tuple(sorted(list(themes1)))
    key2=tuple(sorted(list(themes2)))
    if (key1,key2) in CACHE1:
        return CACHE1[(key1,key2)]
    if (key2,key1) in CACHE1:
        return CACHE1[(key2,key1)]
        
    def _SC(themes,key):
        if key in CACHE2:
            return CACHE2[key]
        sum1=0.0
        for t1 in themes:
            sum2=0.0
            for t2 in themes:
                if t1==t2:
                    sim=1.0
                elif (t1,t2) in CACHE3:
                    sim=CACHE3[(t1,t2)]
                elif (t2,t1) in CACHE3:
                    sim=CACHE3[(t2,t1)]
                else:
                    sim=theme_sim(t1,t2)**p
                    CACHE3[(t1,t2)]=sim
                sum2+=sim
            #sum1+=info([t1])/sum2
            sum1+=1/sum2
                      
        CACHE2[key]=sum1
        return sum1

    A=_SC(themes1,key1)
    B=_SC(themes2,key2)
    union=themes1.union(themes2)
    key_union=tuple(sorted(list(union)))
    A_union_B=_SC(union,key_union)
    A_int_B=A+B-A_union_B

    if coef=="cosine":
        CACHE1[(key1,key2)]=A_int_B/math.sqrt(A*B)
        CACHE1[(key2,key1)]=A_int_B/math.sqrt(A*B)
        return A_int_B/math.sqrt(A*B)
    elif coef=="Jaccard":
        return A_int_B/A_union_B
    elif coef=="Dice":
        return 2*A_int_B/(A+B)
    
    CACHE1[(key1,key2)]=A_int_B/math.sqrt(A*B)
    return A_int_B/math.sqrt(A*B)
            
    
    
    
def cosine_idf(A,B,A_int_B,A_union_B):
    numerator=0.0
    for theme in A_int_B:
        numerator+=IDF[theme]**2
    normA=0.0
    for theme in A:
        normA+=IDF[theme]**2
    normB=0.0
    for theme in B:
        normB+=IDF[theme]**2
    return numerator/math.sqrt(normA*normB)
        
    



#CARDINALITY BASED COEFFICIENTS
similarity_functions={
"COSINE_IDF"    :cosine_idf,
#"COSINE"        :lambda A,B,A_int_B,A_union_B:len(A_int_B)/math.sqrt(len(A)*len(B)),
"JACCARD"       :lambda A,B,A_int_B,A_union_B:len(A_int_B)/len(A_union_B),
"DICE"          :lambda A,B,A_int_B,A_union_B:2*len(A_int_B)/(len(A)+len(B)),
# "OVERLAP"       :lambda A,B,A_int_B,A_union_B:len(A_int_B)/min([len(A),len(B)]),
# "INTERSECTION"  :lambda A,B,A_int_B,A_union_B:len(A_int_B),                                                     
#"COSINE_IC"     :lambda A,B,A_int_B,A_union_B:info(A_int_B)/math.sqrt(info(A)*info(B)),
"JACCARD_IC"    :lambda A,B,A_int_B,A_union_B:info(A_int_B)/info(A_union_B),
"DICE_IC"       :lambda A,B,A_int_B,A_union_B:2*info(A_int_B)/(info(A)+info(B)),
#"INTERSECTION_IC":lambda A,B,A_int_B,A_union_B:info(A_int_B),        
                                                    }                                                

# JUST COMMENT WITH A '#' THE LINE OF THE FUNCTION TO OMIT IN THE RUN
theme_sim_functions=(
        "path",
        "path1",
        "lch",
        "wup",
        "res",
        "lin",
        "linc",
        "jcn",
        "cos",
        "wup_cos",
        "lin_cos",
        "res_cos",
        "path_cos",
        )

for name in theme_sim_functions:
    for sc_coeff in ["cosine",]:#"Jaccard"]:
        for p_ in ["01","02","03","04","05","06","08","09","10",]:   # THE VALUES OF 'P' (the soft cardinality's paramenter) TO USE.
        #for p_ in ["20","25","30","35","40","45","50"]:
            similarity_functions["SC_"+sc_coeff+"_"+name+"_p"+str(p_)]=eval("lambda A,B,A_int_B,A_union_B:SC(A,B,"+name+",p="+str(int(p_))+",coef='"+sc_coeff+"')")

RESULTS={
"MAP":dict([(method,dict([(x,0) for x in BM])) for method in similarity_functions]),
"P@10":dict([(method,dict([(x,0) for x in BM])) for method in similarity_functions]),
}





#MyMediaLite_path="../IMDB/star_trek/"
#item attributes
att_file=open(MyMediaLite_path+"item_attributes.txt","w")
for item_id in EPISODE_THEMES:
    for theme in EPISODE_THEMES[item_id][0]:
        att_file.write("{0} {1}\n".format(item_id,theme))
    for theme in EPISODE_THEMES[item_id][1]:
        att_file.write("{0} {1}\n".format(item_id,theme))
att_file.close()

# reads MyMediaLite items mapping
item_mapping_MyMediaLite=[]
mapping_file=open(MyMediaLite_path+"item_mapping.txt","r")
for line in mapping_file:
    tab_pos=line.find("\t")
    if tab_pos>0:
        episode_id=line[tab_pos+1:].strip()
        item_mapping_MyMediaLite.append(episode_id)
mapping_file.close()
#print(item_mapping_MyMediaLite)
print("MyMediaLite mapping read,",len(item_mapping_MyMediaLite),"items")

#reads MyMediaLite KNN item similarity matrixmodel
knn_item_sim={}
knn_file=open(MyMediaLite_path+"knn.model","r")
num_line=0
row=[]
file_header=""
for line in knn_file:
    if num_line==0: #MyMediaLite model name
        num_line+=1
        file_header+=line
        continue
    if num_line==1: #MyMediaLite version
        num_line+=1
        file_header+=line
        continue
    if num_line==2: #MyMediaLite correlation type
        num_line+=1
        correlation_type=line.strip()
        file_header+=line
        continue
    if num_line==3: #MyMediaLite number of items
        num_line+=1
        N=int(line)
        file_header+=line
        continue
    i,j,sim_value=line.split(" ")
    i=int(i)
    j=int(j)
    sim_value=float(sim_value)
    knn_item_sim[(i,j)]=sim_value
    num_line+=1
knn_file.close()
print(num_line,"entries read from KNN sim matrix")
    


for similarity_function_name in sorted(list(similarity_functions.keys())):
    print("Generating MyMediaLite IKNN model for similarity function",similarity_function_name)
    similarity_function=similarity_functions[similarity_function_name]
    CACHE1={}
    CACHE2={}
    CACHE3={}
   
    output_file=open(MyMediaLite_path+"knn_"+similarity_function_name+".model","w")
    output_file.write(file_header)
    #similarity matrix generation
    MyMediaLite_sims=[]
    Ontology_sims=[]
    episode_sim_matrix={}
    for i in range(N):
        for j in range(i+1,N):
            story_1_id=item_mapping_MyMediaLite[i]
            story_2_id=item_mapping_MyMediaLite[j]
    
            story_1_themes=set(EPISODE_THEMES[story_1_id][0]+EPISODE_THEMES[story_1_id][1])-blacklist
            story_2_themes=set(EPISODE_THEMES[story_2_id][0]+EPISODE_THEMES[story_2_id][1])-blacklist
            
            #replaces theme by its parent theme
            story_1_themes=set([PARENT_NODE[theme] for theme in story_1_themes])
            story_2_themes=set([PARENT_NODE[theme] for theme in story_2_themes])
            
            
            #similarity computation
            intersection=story_1_themes.intersection(story_2_themes)
            union=story_1_themes.union(story_2_themes)
            episode_similarity=similarity_function(story_1_themes,story_2_themes,intersection,union)
            episode_sim_matrix[(min(story_1_id,story_2_id),max(story_1_id,story_2_id))]=episode_similarity
            #episode_similarity=random.random()            
            if (i,j) in knn_item_sim:
                knn_similarity=knn_item_sim[(i,j)]
            else:
                knn_similarity=0.0
            combined_similarity=0.5*(episode_similarity+knn_similarity)
            #combined_similarity=math.sqrt(episode_similarity*knn_similarity)
            #combined_similarity=1.0
            combined_similarity=episode_similarity
            #combined_similarity=episode_similarity*0.8+knn_similarity*0.2
            #combined_similarity=random.random()
            #print(story_1_id,story_2_id,episode_similarity,knn_similarity)            
            MyMediaLite_sims.append(knn_similarity)
            Ontology_sims.append(episode_similarity)

            if combined_similarity!=0:
                output_file.write("{0} {1} {2}\n".format(i,j,combined_similarity))
                #print("{0} {1} {2}\n".format(i,j,combined_similarity))
    output_file.close()

    output_file=open("pickled_sim_matrices/PARENT_SIM_"+similarity_function_name+".pkl","wb")
    pickle.dump(episode_sim_matrix,output_file)
    output_file.close()
    
    #clones the global effects file with the new model filename
    input_file=open(MyMediaLite_path+"knn.model-global-effects","r")
    output_file=open(MyMediaLite_path+"knn_"+similarity_function_name+".model-global-effects","w")
    for line in input_file:
        if line[:2]=="0." or line[:3]=="-0.":
            output_file.write(line)
            #output_file.write("0\n")
        else:
            output_file.write(line)
    #text=input_file.read()
    #output_file.write(text)
    output_file.close()
    input_file.close()
    #print(pearsonr(MyMediaLite_sims,Ontology_sims))
    
    continue

    sum_method={"P@10":0.0,"DUNN":0.0,"CONTRAST":0.0,"MAP":0.0,"MAP1":0.0}
    for story_set_id in sorted_story_sets_ids:
        story_set_name=BM[story_set_id][0]
        print("\t"+story_set_name,end=" ")
        story_set=set(BM[story_set_id][1:])
        
        
        # PRECISION AT 10 (P@10)
        sum_precision_at_10=0.0
        N=0
        sum_MAP=0.0
        #Q=[]
        for story_1_id in story_set:
            story_1_themes=set(EPISODE_THEMES[story_1_id][0]+EPISODE_THEMES[story_1_id][1])-blacklist
            ranked_episodes=[]
            for story_2_id in STORIES:
                if story_1_id==story_2_id:
                    continue
                story_2_themes=set(EPISODE_THEMES[story_2_id][0]+EPISODE_THEMES[story_2_id][1])-blacklist
                intersection=story_1_themes.intersection(story_2_themes)
                union=story_1_themes.union(story_2_themes)
                similarity=similarity_function(story_1_themes,story_2_themes,intersection,union)
                ranked_episodes.append((similarity,story_2_id))
            #ranked_episodes=[x for x in ranked_episodes if x[1]!=story_1_id] # remove story_1_id from the result set
            ranked_episodes.sort(reverse=True)
            ranked_episodes=[x[1] for x in ranked_episodes]
            top_10_episodes=set([x for x in ranked_episodes[:10]])
            precision_at_10=(len(story_set.intersection(top_10_episodes))-0)/10
            sum_precision_at_10+=precision_at_10
            N+=1

            #AP calculation
            AP_sum=0.0
            #print("story_1_id",story_1_id,len(ranked_episodes),len(STORIES))
            #print(ranked_episodes)
            for s in story_set-set([story_1_id]):
                k=ranked_episodes.index(s)+1 # attention k is a zero-based index
                precision_at_k=len(story_set.intersection(set(ranked_episodes[:k])))/k
                AP_sum+=precision_at_k
            sum_MAP+=AP_sum/(len(story_set)-1)
        
        
        RESULTS["MAP"][similarity_function_name][story_set_id]=sum_MAP/N
        print(sum_MAP/N,end=" ")
        sum_method["MAP"]+=sum_MAP/N

        
        RESULTS["P@10"][similarity_function_name][story_set_id]=sum_precision_at_10/N
        print(sum_precision_at_10/N,end="")
        sum_method["P@10"]+=sum_precision_at_10/N

        print()    

    #PRINT AVERAGES
    print("Average",sum_method["MAP"]/len(BM),end=" ")
    print(sum_method["P@10"]/len(BM),end=" ")
    print()
    
      
    
    
    
    # CLEAR CACHEs
    print(len(CACHE1),len(CACHE2),len(CACHE3))
    try:
        max_theme_sim=max([CACHE3[x] for x in CACHE3])
        min_theme_sim=min([CACHE3[x] for x in CACHE3])
        print("Theme max:min similarity",max_theme_sim,min_theme_sim)
    except:
        pass
    CACHE1={}
    CACHE2={}
    CACHE3={}










#PRINT RESULTS

for evaluation_measure in ["MAP","P@10"]:
    print("Evaluation measure:",evaluation_measure)
    print("STORY_SET",end=" ")
    for method in sorted(list(RESULTS[evaluation_measure])):
        print(method,end=" ")
    print()
    averages=dict([(x,0) for x in RESULTS[evaluation_measure]])
    for story_set_id in sorted_story_sets_ids:
        print(BM[story_set_id][0],end=" ")
        summation=0.0
        n=0
        for method in sorted(list(RESULTS[evaluation_measure])):
            print(round(RESULTS[evaluation_measure][method][story_set_id],6),end=" ")
            averages[method]+=RESULTS[evaluation_measure][method][story_set_id]
        print()
    print("Avg."+evaluation_measure,end=" ")
    for method in sorted(list(RESULTS[evaluation_measure])):
        print(round(averages[method]/len(BM),6),end=" ")
    print()

                 
    
        
        
    

print("Done!")
